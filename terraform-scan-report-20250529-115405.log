=================================================================
          TERRAFORM SECURITY SCAN REPORT
=================================================================


============================================================
[2025-05-29 11:54:05] üöÄ Terraform Scanner v2.0 - Comprehensive Logging
============================================================
[2025-05-29 11:54:05] üìÅ Target: test-files/terraform/main.tf
[2025-05-29 11:54:05] üìç Working directory: /work
[2025-05-29 11:54:05] üïê Scan started: Thu May 29 11:54:05 UTC 2025
[2025-05-29 11:54:05] üìä Output format: Comprehensive log with all tool outputs
[2025-05-29 11:54:05] ‚úÖ SUCCESS: Target 'test-files/terraform/main.tf' found and accessible
[2025-05-29 11:54:05] üìÑ Scanning single Terraform file: test-files/terraform/main.tf
[2025-05-29 11:54:05] üìã File information:
-rwxrwxrwx    1 root     root         10181 May 28 18:02 test-files/terraform/main.tf

============================================================
[2025-05-29 11:54:05] üîß Running TFLint - Terraform Linter
============================================================
[2025-05-29 11:54:05] Running TFLint scan on file...
[2025-05-29 11:54:06] ‚úÖ SUCCESS: TFLint scan completed successfully

============================================================
[2025-05-29 11:54:06] üîí Running TFSec - Terraform Security Scanner
============================================================
[2025-05-29 11:54:06] Running TFSec security scan on file...

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
Error: provided path is not a dir
[2025-05-29 11:54:07] ‚úÖ SUCCESS: TFSec scan completed - no security issues found

============================================================
[2025-05-29 11:54:07] üõ°Ô∏è Running Checkov - Infrastructure Security Scanner
============================================================
[2025-05-29 11:54:07] Running Checkov scan on file...


       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.414 
Update available 3.2.414 -> 3.2.435
Run pip3 install -U checkov to update 


terraform scan results:

Passed checks: 23, Failed checks: 50, Skipped checks: 0

Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24
Check: CKV_AWS_88: "EC2 instance should not have public IP."
	PASSED for resource: aws_instance.vulnerable_instance
	File: /main.tf:98-152
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12
Check: CKV_AWS_46: "Ensure no hard-coded secrets exist in EC2 user data"
	PASSED for resource: aws_instance.vulnerable_instance
	File: /main.tf:98-152
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1
Check: CKV_AWS_277: "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1"
	PASSED for resource: aws_security_group.vulnerable_sg
	File: /main.tf:155-205
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports
Check: CKV_AWS_25: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389"
	PASSED for resource: aws_security_group.vulnerable_sg
	File: /main.tf:155-205
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2
Check: CKV_AWS_133: "Ensure that RDS instances has backup policy"
	PASSED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-rds-instances-have-backup-policy
Check: CKV_AWS_211: "Ensure RDS uses a modern CaCert"
	PASSED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-rds-uses-a-modern-cacert
Check: CKV_AWS_354: "Ensure RDS Performance Insights are encrypted using KMS CMKs"
	PASSED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-354
Check: CKV_AZURE_244: "Avoid the use of local users for Azure Storage unless necessary"
	PASSED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-244
Check: CKV_AZURE_36: "Ensure 'Trusted Microsoft Services' is enabled for Storage Account access"
	PASSED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/enable-trusted-microsoft-services-for-storage-account-access
Check: CKV_GCP_35: "Ensure 'Enable connecting to serial ports' is not enabled for VM Instance"
	PASSED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-11
Check: CKV_GCP_30: "Ensure that instances are not configured to use the default service account"
	PASSED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-gcp-iam-1
Check: CKV_GCP_36: "Ensure that IP forwarding is not enabled on Instances"
	PASSED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-12
Check: CKV_GCP_31: "Ensure that instances are not configured to use the default service account with full access to all Cloud APIs"
	PASSED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-gcp-iam-2
Check: CKV_GCP_75: "Ensure Google compute firewall ingress does not allow unrestricted FTP access"
	PASSED for resource: google_compute_firewall.vulnerable_firewall
	File: /main.tf:356-368
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-ftp-access
Check: CKV_GCP_3: "Ensure Google compute firewall ingress does not allow unrestricted rdp access"
	PASSED for resource: google_compute_firewall.vulnerable_firewall
	File: /main.tf:356-368
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-2
Check: CKV_GCP_77: "Ensure Google compute firewall ingress does not allow on ftp port"
	PASSED for resource: google_compute_firewall.vulnerable_firewall
	File: /main.tf:356-368
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-ftp-port-20-access
Check: CKV2_GCP_12: "Ensure GCP compute firewall ingress does not allow unrestricted access to all ports"
	PASSED for resource: google_compute_firewall.vulnerable_firewall
	File: /main.tf:356-368
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-access-to-all-ports
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone
Check: CKV2_AWS_5: "Ensure that Security Groups are attached to another resource"
	PASSED for resource: aws_security_group.vulnerable_sg
	File: /main.tf:155-205
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis
Check: CKV2_AWS_69: "Ensure AWS RDS database instance configured with encryption in transit"
	PASSED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-69
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	FAILED for resource: aws.default
	File: /main.tf:31-36
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5

		31 | provider "aws" {
		32 |   region = var.aws_region
		33 |   # Issue: Hardcoded credentials (should use IAM roles/profiles)
		34 |   access_key = "AKIAI**********"
		35 |   secret_key = "wJalrX**********"
		36 | }

Check: CKV_AWS_55: "Ensure S3 bucket has ignore public ACLs enabled"
	FAILED for resource: aws_s3_bucket_public_access_block.vulnerable_bucket_pab
	File: /main.tf:69-76
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21

		69 | resource "aws_s3_bucket_public_access_block" "vulnerable_bucket_pab" {
		70 |   bucket = aws_s3_bucket.vulnerable_bucket.id
		71 | 
		72 |   block_public_acls       = false
		73 |   block_public_policy     = false
		74 |   ignore_public_acls      = false
		75 |   restrict_public_buckets = false
		76 | }

Check: CKV_AWS_56: "Ensure S3 bucket has 'restrict_public_buckets' enabled"
	FAILED for resource: aws_s3_bucket_public_access_block.vulnerable_bucket_pab
	File: /main.tf:69-76
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22

		69 | resource "aws_s3_bucket_public_access_block" "vulnerable_bucket_pab" {
		70 |   bucket = aws_s3_bucket.vulnerable_bucket.id
		71 | 
		72 |   block_public_acls       = false
		73 |   block_public_policy     = false
		74 |   ignore_public_acls      = false
		75 |   restrict_public_buckets = false
		76 | }

Check: CKV_AWS_53: "Ensure S3 bucket has block public ACLS enabled"
	FAILED for resource: aws_s3_bucket_public_access_block.vulnerable_bucket_pab
	File: /main.tf:69-76
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19

		69 | resource "aws_s3_bucket_public_access_block" "vulnerable_bucket_pab" {
		70 |   bucket = aws_s3_bucket.vulnerable_bucket.id
		71 | 
		72 |   block_public_acls       = false
		73 |   block_public_policy     = false
		74 |   ignore_public_acls      = false
		75 |   restrict_public_buckets = false
		76 | }

Check: CKV_AWS_54: "Ensure S3 bucket has block public policy enabled"
	FAILED for resource: aws_s3_bucket_public_access_block.vulnerable_bucket_pab
	File: /main.tf:69-76
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20

		69 | resource "aws_s3_bucket_public_access_block" "vulnerable_bucket_pab" {
		70 |   bucket = aws_s3_bucket.vulnerable_bucket.id
		71 | 
		72 |   block_public_acls       = false
		73 |   block_public_policy     = false
		74 |   ignore_public_acls      = false
		75 |   restrict_public_buckets = false
		76 | }

Check: CKV_AWS_135: "Ensure that EC2 is EBS optimized"
	FAILED for resource: aws_instance.vulnerable_instance
	File: /main.tf:98-152
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_126: "Ensure that detailed monitoring is enabled for EC2 instances"
	FAILED for resource: aws_instance.vulnerable_instance
	File: /main.tf:98-152
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_79: "Ensure Instance Metadata Service Version 1 is not enabled"
	FAILED for resource: aws_instance.vulnerable_instance
	File: /main.tf:98-152
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_8: "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"
	FAILED for resource: aws_instance.vulnerable_instance
	File: /main.tf:98-152
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_24: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"
	FAILED for resource: aws_security_group.vulnerable_sg
	File: /main.tf:155-205
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_23: "Ensure every security group and rule has a description"
	FAILED for resource: aws_security_group.vulnerable_sg
	File: /main.tf:155-205
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_260: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"
	FAILED for resource: aws_security_group.vulnerable_sg
	File: /main.tf:155-205
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_382: "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"
	FAILED for resource: aws_security_group.vulnerable_sg
	File: /main.tf:155-205
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_161: "Ensure RDS database has IAM authentication enabled"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-rds-database-has-iam-authentication-enabled

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV_AWS_16: "Ensure all data stored in the RDS is securely encrypted at rest"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-4

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV_AWS_129: "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-that-respective-logs-of-amazon-relational-database-service-amazon-rds-are-enabled

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV_AWS_157: "Ensure that RDS instances have Multi-AZ enabled"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-73

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV_AWS_293: "Ensure that AWS database instances have deletion protection enabled"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-293

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV_AWS_17: "Ensure all data stored in RDS is not publicly accessible"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-2

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV_AWS_118: "Ensure that enhanced monitoring is enabled for Amazon RDS instances"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV_AWS_226: "Ensure DB instance gets all minor upgrades automatically"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-db-instance-gets-all-minor-upgrades-automatically

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV_AZURE_44: "Ensure Storage Account is using the latest version of TLS encryption"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-storage-policies/bc-azr-storage-2

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV_AZURE_206: "Ensure that Storage Accounts use replication"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-206

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV_AZURE_59: "Ensure that Storage accounts disallow public access"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV_AZURE_33: "Ensure Storage logging is enabled for Queue service for read, write and delete requests"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-logging-policies/enable-requests-on-storage-logging-for-queue-service

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV_AZURE_190: "Ensure that Storage blobs restrict public access"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/azr-networking-190

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV_AZURE_3: "Ensure that 'enable_https_traffic_only' is enabled"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-3

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV_GCP_34: "Ensure that no instance in the project overrides the project setting for enabling OSLogin(OSLogin needs to be enabled in project metadata for all instances)"
	FAILED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-10

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_38: "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)"
	FAILED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-general-policies/encrypt-boot-disks-for-instances-with-cseks

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_39: "Ensure Compute instances are launched with Shielded VM enabled"
	FAILED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-general-policies/bc-gcp-general-y

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_32: "Ensure 'Block Project-wide SSH keys' is enabled for VM instances"
	FAILED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-8

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_40: "Ensure that Compute instances do not have public IP addresses"
	FAILED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-public-policies/bc-gcp-public-2

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_106: "Ensure Google compute firewall ingress does not allow unrestricted http port 80 access"
	FAILED for resource: google_compute_firewall.vulnerable_firewall
	File: /main.tf:356-368
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-http-port-80-access

		356 | resource "google_compute_firewall" "vulnerable_firewall" {
		357 |   name    = "vulnerable-firewall"
		358 |   network = "default"
		359 |   
		360 |   allow {
		361 |     protocol = "tcp"
		362 |     ports    = ["22", "80", "443", "3306", "5432", "1433"]
		363 |   }
		364 |   
		365 |   # Issue: Source ranges too broad
		366 |   source_ranges = ["0.0.0.0/0"]
		367 |   target_tags   = ["webserver", "database"]
		368 | }

Check: CKV_GCP_2: "Ensure Google compute firewall ingress does not allow unrestricted ssh access"
	FAILED for resource: google_compute_firewall.vulnerable_firewall
	File: /main.tf:356-368
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-1

		356 | resource "google_compute_firewall" "vulnerable_firewall" {
		357 |   name    = "vulnerable-firewall"
		358 |   network = "default"
		359 |   
		360 |   allow {
		361 |     protocol = "tcp"
		362 |     ports    = ["22", "80", "443", "3306", "5432", "1433"]
		363 |   }
		364 |   
		365 |   # Issue: Source ranges too broad
		366 |   source_ranges = ["0.0.0.0/0"]
		367 |   target_tags   = ["webserver", "database"]
		368 | }

Check: CKV_GCP_88: "Ensure Google compute firewall ingress does not allow unrestricted mysql access"
	FAILED for resource: google_compute_firewall.vulnerable_firewall
	File: /main.tf:356-368
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-compute-firewall-ingress-does-not-allow-unrestricted-mysql-access

		356 | resource "google_compute_firewall" "vulnerable_firewall" {
		357 |   name    = "vulnerable-firewall"
		358 |   network = "default"
		359 |   
		360 |   allow {
		361 |     protocol = "tcp"
		362 |     ports    = ["22", "80", "443", "3306", "5432", "1433"]
		363 |   }
		364 |   
		365 |   # Issue: Source ranges too broad
		366 |   source_ranges = ["0.0.0.0/0"]
		367 |   target_tags   = ["webserver", "database"]
		368 | }

Check: CKV2_AZURE_33: "Ensure storage account is configured with private endpoint"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-33

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV2_AZURE_40: "Ensure storage account is not configured with Shared Key authorization"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-iam-policies/bc-azure-2-40

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV2_AZURE_47: "Ensure storage account is configured without blob anonymous access"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-iam-policies/bc-azure-2-47

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV2_AZURE_41: "Ensure storage account is configured with SAS expiration policy"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-iam-policies/bc-azure-2-41

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV2_AZURE_38: "Ensure soft-delete is enabled on Azure storage account"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-38

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV2_AZURE_1: "Ensure storage for critical data are encrypted with Customer Managed Key"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV2_AWS_60: "Ensure RDS instance with copy tags to snapshots is enabled"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-60

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62

		57 | resource "aws_s3_bucket" "vulnerable_bucket" {
		58 |   bucket = "my-super-secret-company-data-${random_string.bucket_suffix.result}"
		59 |   
		60 |   tags = {
		61 |     Environment = "production"
		62 |     # Issue: Sensitive information in tags
		63 |     DatabasePassword = "admin123"
		64 |     ApiKey          = var.api_key
		65 |   }
		66 | }

Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61

		57 | resource "aws_s3_bucket" "vulnerable_bucket" {
		58 |   bucket = "my-super-secret-company-data-${random_string.bucket_suffix.result}"
		59 |   
		60 |   tags = {
		61 |     Environment = "production"
		62 |     # Issue: Sensitive information in tags
		63 |     DatabasePassword = "admin123"
		64 |     ApiKey          = var.api_key
		65 |   }
		66 | }

Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled

		57 | resource "aws_s3_bucket" "vulnerable_bucket" {
		58 |   bucket = "my-super-secret-company-data-${random_string.bucket_suffix.result}"
		59 |   
		60 |   tags = {
		61 |     Environment = "production"
		62 |     # Issue: Sensitive information in tags
		63 |     DatabasePassword = "admin123"
		64 |     ApiKey          = var.api_key
		65 |   }
		66 | }

Check: CKV2_AWS_41: "Ensure an IAM role is attached to EC2 instance"
	FAILED for resource: aws_instance.vulnerable_instance
	File: /main.tf:98-152
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging

		57 | resource "aws_s3_bucket" "vulnerable_bucket" {
		58 |   bucket = "my-super-secret-company-data-${random_string.bucket_suffix.result}"
		59 |   
		60 |   tags = {
		61 |     Environment = "production"
		62 |     # Issue: Sensitive information in tags
		63 |     DatabasePassword = "admin123"
		64 |     ApiKey          = var.api_key
		65 |   }
		66 | }

Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	FAILED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached

		57 | resource "aws_s3_bucket" "vulnerable_bucket" {
		58 |   bucket = "my-super-secret-company-data-${random_string.bucket_suffix.result}"
		59 |   
		60 |   tags = {
		61 |     Environment = "production"
		62 |     # Issue: Sensitive information in tags
		63 |     DatabasePassword = "admin123"
		64 |     ApiKey          = var.api_key
		65 |   }
		66 | }

Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default

		57 | resource "aws_s3_bucket" "vulnerable_bucket" {
		58 |   bucket = "my-super-secret-company-data-${random_string.bucket_suffix.result}"
		59 |   
		60 |   tags = {
		61 |     Environment = "production"
		62 |     # Issue: Sensitive information in tags
		63 |     DatabasePassword = "admin123"
		64 |     ApiKey          = var.api_key
		65 |   }
		66 | }

Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning

		57 | resource "aws_s3_bucket" "vulnerable_bucket" {
		58 |   bucket = "my-super-secret-company-data-${random_string.bucket_suffix.result}"
		59 |   
		60 |   tags = {
		61 |     Environment = "production"
		62 |     # Issue: Sensitive information in tags
		63 |     DatabasePassword = "admin123"
		64 |     ApiKey          = var.api_key
		65 |   }
		66 | }


[2025-05-29 11:54:15] ‚úÖ SUCCESS: Checkov scan completed - no issues found

============================================================
[2025-05-29 11:54:15] üìä Scan Summary and Results
============================================================
[2025-05-29 11:54:15] Target: test-files/terraform/main.tf
[2025-05-29 11:54:15] Scan type: file
[2025-05-29 11:54:15] üïê Scan completed: Thu May 29 11:54:15 UTC 2025
[2025-05-29 11:54:15] ============================================================
[2025-05-29 11:54:15] TOOL EXECUTION RESULTS:
[2025-05-29 11:54:15] - TFLint: ‚úÖ PASSED
[2025-05-29 11:54:15] - TFSec: ‚úÖ PASSED
[2025-05-29 11:54:15] - Checkov: ‚úÖ PASSED
[2025-05-29 11:54:15] ============================================================
[2025-05-29 11:54:15] ‚úÖ SUCCESS: Overall scan result: ALL TOOLS PASSED - No critical issues found!
[2025-05-29 11:54:15] üìÑ Complete scan log saved to: terraform-scan-report-20250529-115405.log
[2025-05-29 11:54:15] üéØ All tool outputs captured with timestamps and exit codes
