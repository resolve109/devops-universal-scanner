=================================================================
          TERRAFORM SECURITY SCAN REPORT
=================================================================


============================================================
[2025-05-29 03:27:17] 🚀 Terraform Scanner v2.0 - Comprehensive Logging
============================================================
[2025-05-29 03:27:17] 📁 Target: test-files/terraform/
[2025-05-29 03:27:17] 📍 Working directory: /work
[2025-05-29 03:27:17] 🕐 Scan started: Thu May 29 03:27:17 UTC 2025
[2025-05-29 03:27:17] 📊 Output format: Comprehensive log with all tool outputs
[2025-05-29 03:27:17] ✅ SUCCESS: Target 'test-files/terraform/' found and accessible
[2025-05-29 03:27:17] 📂 Scanning Terraform directory: test-files/terraform/
[2025-05-29 03:27:17] 📋 Terraform files found:
test-files/terraform/kubernetes-clusters.tf
test-files/terraform/main.tf
test-files/terraform/outputs.tf
test-files/terraform/providers.tf
test-files/terraform/variables.tf

============================================================
[2025-05-29 03:27:17] 🔧 Running TFLint - Terraform Linter
============================================================
[2025-05-29 03:27:17] Initializing TFLint...
All plugins are already installed
[2025-05-29 03:27:17] ✅ SUCCESS: TFLint initialization completed
[2025-05-29 03:27:17] Running TFLint scan on directory...
15 issue(s) found:

Warning: Missing version constraint for provider "random" in `required_providers` (terraform_required_providers)

  on providers.tf line 21:
  21:     random = {
  22:       source = "hashicorp/random"
  23:       # version = "~> 3.0"  # Should specify version constraints
  24:     }

Reference: https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.12.0/docs/rules/terraform_required_providers.md

Warning: [Fixable] local.common_tags is declared but not used (terraform_unused_declarations)

  on providers.tf line 114:
 114:   common_tags = {
 115:     Environment   = var.environment
 116:     Project       = "devops-scanner"
 117:     ManagedBy     = "terraform"
 118:     Owner         = "devops-team"
 119:     # Issue: Sensitive information in tags
 120:     AdminContact  = "admin@company.com"
 121:     BudgetCode    = "BUDGET-12345"
 122:     CostCenter    = "CC-9999"
 123:   }

Reference: https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.12.0/docs/rules/terraform_unused_declarations.md

Warning: [Fixable] local.database_config is declared but not used (terraform_unused_declarations)

  on providers.tf line 126:
 126:   database_config = {
 127:     username = "admin"
 128:     password = "admin123"  # Should use random_password or external source
 129:     port     = 3306
 130:     database = "application_db"
 131:   }

Reference: https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.12.0/docs/rules/terraform_unused_declarations.md

Warning: [Fixable] local.resource_prefix is declared but not used (terraform_unused_declarations)

  on providers.tf line 134:
 134:   resource_prefix = "${var.environment}-${var.gcp_project_id}"

Reference: https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.12.0/docs/rules/terraform_unused_declarations.md

Warning: [Fixable] local.allowed_ports is declared but not used (terraform_unused_declarations)

  on providers.tf line 137:
 137:   allowed_ports = [22, 80, 443, 3306, 5432, 1433, 6379, 27017]

Reference: https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.12.0/docs/rules/terraform_unused_declarations.md

Warning: [Fixable] local.trusted_networks is declared but not used (terraform_unused_declarations)

  on providers.tf line 140:
 140:   trusted_networks = [
 141:     "0.0.0.0/0",      # Issue: Allows all traffic
 142:     "10.0.0.0/8",     # Issue: Entire private network
 143:     "172.16.0.0/12",  # Issue: Entire private network
 144:     "192.168.0.0/16"  # Issue: Entire private network
 145:   ]

Reference: https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.12.0/docs/rules/terraform_unused_declarations.md

Warning: [Fixable] variable "encryption_key" is declared but not used (terraform_unused_declarations)

  on variables.tf line 63:
  63: variable "encryption_key" {

Reference: https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.12.0/docs/rules/terraform_unused_declarations.md

Warning: [Fixable] variable "database_connection_string" is declared but not used (terraform_unused_declarations)

  on variables.tf line 71:
  71: variable "database_connection_string" {

Reference: https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.12.0/docs/rules/terraform_unused_declarations.md

Warning: [Fixable] variable "instance_size" is declared but not used (terraform_unused_declarations)

  on variables.tf line 135:
 135: variable "instance_size" {

Reference: https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.12.0/docs/rules/terraform_unused_declarations.md

Warning: [Fixable] variable "allowed_cidr_blocks" is declared but not used (terraform_unused_declarations)

  on variables.tf line 146:
 146: variable "allowed_cidr_blocks" {

Reference: https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.12.0/docs/rules/terraform_unused_declarations.md

Warning: [Fixable] variable "storage_account_name" is declared but not used (terraform_unused_declarations)

  on variables.tf line 160:
 160: variable "storage_account_name" {

Reference: https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.12.0/docs/rules/terraform_unused_declarations.md

Warning: [Fixable] variable "application_port" is declared but not used (terraform_unused_declarations)

  on variables.tf line 171:
 171: variable "application_port" {

Reference: https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.12.0/docs/rules/terraform_unused_declarations.md

Warning: [Fixable] variable "enable_encryption" is declared but not used (terraform_unused_declarations)

  on variables.tf line 182:
 182: variable "enable_encryption" {

Reference: https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.12.0/docs/rules/terraform_unused_declarations.md

Warning: [Fixable] variable "enable_monitoring" is declared but not used (terraform_unused_declarations)

  on variables.tf line 189:
 189: variable "enable_monitoring" {

Reference: https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.12.0/docs/rules/terraform_unused_declarations.md

Warning: [Fixable] variable "enable_backup" is declared but not used (terraform_unused_declarations)

  on variables.tf line 196:
 196: variable "enable_backup" {

Reference: https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.12.0/docs/rules/terraform_unused_declarations.md

[2025-05-29 03:27:17] ✅ SUCCESS: TFLint scan completed successfully

============================================================
[2025-05-29 03:27:17] 🔒 Running TFSec - Terraform Security Scanner
============================================================
[2025-05-29 03:27:17] Running TFSec security scan on directory...

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[1m[31mCRITICAL[39m[0m[39m[0m [1mPublic cluster access is enabled.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:15
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m    7  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_eks_cluster"[0m [38;5;37m"vulnerable_cluster"[0m {[0m
[0m[90m    .  [0m
[0m[31m   15  [0m[0m[31m[[39m[0m[0m [0m    [38;5;245mendpoint_public_access[0m  = [38;5;166mtrue[0m[0m [3m[2m[3m(true)[0m
[0m[90m   ..  [0m
[0m[90m   33  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-eks-no-public-cluster-access
[0m[0m  [2m    Impact[0m EKS can be access from the internet
[0m[0m  [2mResolution[0m Don't enable public access to EKS Clusters
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/eks/no-public-cluster-access/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#endpoint_public_access[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #2[0m [0m[1m[31mCRITICAL[39m[0m[39m[0m [1mCluster allows access from a public CIDR: 0.0.0.0/0.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:16
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m    7  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_eks_cluster"[0m [38;5;37m"vulnerable_cluster"[0m {[0m
[0m[90m    .  [0m
[0m[31m   16  [0m[0m[31m[[39m[0m[0m [0m    [38;5;245mpublic_access_cidrs[0m     = [[38;5;37m"0.0.0.0/0"[0m][38;5;239m  # Open to internet[0m
[0m[90m   ..  [0m
[0m[90m   33  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-eks-no-public-cluster-access-to-cidr
[0m[0m  [2m    Impact[0m EKS can be accessed from the internet
[0m[0m  [2mResolution[0m Don't enable public access to EKS Clusters
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/eks/no-public-cluster-access-to-cidr/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#vpc_config[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #3[0m [0m[1m[31mCRITICAL[39m[0m[39m[0m [1mCluster does not limit API access to specific IP addresses.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:63-116
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[31m   63  [0m[0m[31m┌[39m[0m[0m [0m[38;5;33mresource[0m [38;5;37m"azurerm_kubernetes_cluster"[0m [38;5;37m"vulnerable_aks"[0m {[0m
[0m[31m   64  [0m[0m[31m│[39m[0m[0m   [38;5;245mname[0m                = [38;5;37m"vulnerable-aks"[0m
[0m[31m   65  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mlocation[0m            = azurerm_resource_group.main.location[0m
[0m[31m   66  [0m[0m[31m│[39m[0m[0m   [38;5;245mresource_group_name[0m = azurerm_resource_group.main.name[0m
[0m[31m   67  [0m[0m[31m│[39m[0m[0m   [38;5;245mdns_prefix[0m          = [38;5;37m"vulnerable-aks"[0m
[0m[31m   68  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mkubernetes_version[0m  = [38;5;37m"1.19.0"[0m[38;5;239m  # Outdated version[0m
[0m[31m   69  [0m[0m[31m│[39m[0m[0m [0m
[0m[31m   70  [0m[0m[31m│[39m[0m[0m [0m  default_node_pool {[0m
[0m[31m   71  [0m[0m[31m└[39m[0m[0m     [38;5;245mname[0m       = [38;5;37m"default"[0m
[0m[90m   ..  [0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m azure-container-limit-authorized-ips
[0m[0m  [2m    Impact[0m Any IP can interact with the API server
[0m[0m  [2mResolution[0m Limit the access to the API server to a limited IP range
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/azure/container/limit-authorized-ips/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#api_server_authorized_ip_ranges[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #4[0m [0m[1m[31mCRITICAL[39m[0m[39m[0m [1mSecurity group rule allows ingress from public internet.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:165
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  155  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"vulnerable_sg"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  165  [0m[0m[31m[[39m[0m[0m [0m    [38;5;245mcidr_blocks[0m = [[38;5;37m"0.0.0.0/0"[0m][0m
[0m[90m  ...  [0m
[0m[90m  205  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-no-public-ingress-sgr
[0m[0m  [2m    Impact[0m Your port exposed to the internet
[0m[0m  [2mResolution[0m Set a more restrictive cidr range
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #5[0m [0m[1m[31mCRITICAL[39m[0m[39m[0m [1mSecurity group rule allows ingress from public internet.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:174
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  155  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"vulnerable_sg"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  174  [0m[0m[31m[[39m[0m[0m [0m    [38;5;245mcidr_blocks[0m = [[38;5;37m"0.0.0.0/0"[0m][0m
[0m[90m  ...  [0m
[0m[90m  205  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-no-public-ingress-sgr
[0m[0m  [2m    Impact[0m Your port exposed to the internet
[0m[0m  [2mResolution[0m Set a more restrictive cidr range
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #6[0m [0m[1m[31mCRITICAL[39m[0m[39m[0m [1mSecurity group rule allows ingress from public internet.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:183
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  155  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"vulnerable_sg"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  183  [0m[0m[31m[[39m[0m[0m [0m    [38;5;245mcidr_blocks[0m = [[38;5;37m"0.0.0.0/0"[0m][0m
[0m[90m  ...  [0m
[0m[90m  205  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-no-public-ingress-sgr
[0m[0m  [2m    Impact[0m Your port exposed to the internet
[0m[0m  [2mResolution[0m Set a more restrictive cidr range
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #7[0m [0m[1m[31mCRITICAL[39m[0m[39m[0m [1mSecurity group rule allows ingress from public internet.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:191
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  155  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"vulnerable_sg"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  191  [0m[0m[31m[[39m[0m[0m [0m    [38;5;245mcidr_blocks[0m = [[38;5;37m"0.0.0.0/0"[0m][0m
[0m[90m  ...  [0m
[0m[90m  205  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-no-public-ingress-sgr
[0m[0m  [2m    Impact[0m Your port exposed to the internet
[0m[0m  [2mResolution[0m Set a more restrictive cidr range
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #8[0m [0m[1m[31mCRITICAL[39m[0m[39m[0m [1mSecurity group rule allows egress to multiple public internet addresses.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:199
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  155  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"vulnerable_sg"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  199  [0m[0m[31m[[39m[0m[0m [0m    [38;5;245mcidr_blocks[0m = [[38;5;37m"0.0.0.0/0"[0m][0m
[0m[90m  ...  [0m
[0m[90m  205  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-no-public-egress-sgr
[0m[0m  [2m    Impact[0m Your port is egressing data to the internet
[0m[0m  [2mResolution[0m Set a more restrictive cidr range
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #9[0m [0m[1m[31mCRITICAL[39m[0m[39m[0m [1mInstance is exposed publicly.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:224
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  208  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"vulnerable_db"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  224  [0m[0m[31m[[39m[0m[0m [0m  [38;5;245mpublicly_accessible[0m = [38;5;166mtrue[0m[0m[0m [3m[2m[3m(true)[0m
[0m[90m  ...  [0m
[0m[90m  253  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-rds-no-public-db-access
[0m[0m  [2m    Impact[0m The database instance is publicly accessible
[0m[0m  [2mResolution[0m Set the database to not be publicly accessible
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/no-public-db-access/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #10[0m [0m[1m[31mCRITICAL[39m[0m[39m[0m [1mStorage account uses an insecure TLS version.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:285
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  270  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"azurerm_storage_account"[0m [38;5;37m"vulnerable_storage"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  285  [0m[0m[31m[[39m[0m[0m [0m  [38;5;245mmin_tls_version[0m = [38;5;37m"TLS1_0"[0m[0m[0m [3m[3m[2m("TLS1_0")[0m
[0m[90m  ...  [0m
[0m[90m  297  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m azure-storage-use-secure-tls-policy
[0m[0m  [2m    Impact[0m The TLS version being outdated and has known vulnerabilities
[0m[0m  [2mResolution[0m Use a more recent TLS/SSL policy for the load balancer
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/azure/storage/use-secure-tls-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#min_tls_version[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #11[0m [0m[1m[31mCRITICAL[39m[0m[39m[0m [1mFirewall rule allows ingress traffic from multiple addresses on the public internet.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[3m[2m:366
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  356  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"google_compute_firewall"[0m [38;5;37m"vulnerable_firewall"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  366  [0m[0m[31m[[39m[0m[0m [0m  [38;5;245msource_ranges[0m = [[38;5;37m"0.0.0.0/0"[0m][0m
[0m[90m  ...  [0m
[0m[90m  368  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-compute-no-public-ingress
[0m[0m  [2m    Impact[0m The port is exposed for ingress from the internet
[0m[0m  [2mResolution[0m Set a more restrictive cidr range
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/compute/no-public-ingress/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall#source_ranges[0m[0m
  [2m-[0m [34mhttps://www.terraform.io/docs/providers/google/r/compute_firewall.html[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #12[0m [0m[31mHIGH[39m[0m [1mCluster pod security policy is not enforced.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:119-172
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[31m  119  [0m[0m[31m┌[39m[0m[0m [0m[38;5;33mresource[0m [38;5;37m"google_container_cluster"[0m [38;5;37m"vulnerable_gke"[0m {[0m
[0m[31m  120  [0m[0m[31m│[39m[0m[0m   [38;5;245mname[0m     = [38;5;37m"vulnerable-gke"[0m
[0m[31m  121  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mlocation[0m = [38;5;37m"us-central1-a"[0m[0m
[0m[31m  122  [0m[0m[31m│[39m[0m[0m [38;5;239m  [0m
[0m[31m  123  [0m[0m[31m│[39m[0m[0m   # Remove default node pool immediately[0m
[0m[31m  124  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mremove_default_node_pool[0m = [38;5;166mtrue[0m
[0m[31m  125  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245minitial_node_count[0m       = [38;5;37m1[0m[0m
[0m[31m  126  [0m[0m[31m│[39m[0m[0m [38;5;239m[0m
[0m[31m  127  [0m[0m[31m└[39m[0m[0m   # Network configuration with issues[0m
[0m[90m  ...  [0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-gke-enforce-pod-security-policy
[0m[0m  [2m    Impact[0m Pods could be operating with more permissions than required to be effective
[0m[0m  [2mResolution[0m Use security policies for pods to restrict permissions to those needed to be effective
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/gke/enforce-pod-security-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#pod_security_policy_config[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #13[0m [0m[31mHIGH[39m[0m [1mCluster allows the use of certificates for master authentication.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[3m[2m:137
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  119  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"google_container_cluster"[0m [38;5;37m"vulnerable_gke"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  137  [0m[0m[31m[[39m[0m[0m       [38;5;245missue_client_certificate[0m = [38;5;166mtrue[0m[38;5;239m  # Client cert enabled[0m[0m [3m[2m[3m(true)[0m
[0m[90m  ...  [0m
[0m[90m  172  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-gke-no-legacy-authentication
[0m[0m  [2m    Impact[0m Username/password or certificate authentication methods are less secure
[0m[0m  [2mResolution[0m Use service account or OAuth for authentication
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/gke/no-legacy-authentication/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#master_auth[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #14[0m [0m[31mHIGH[39m[0m [1mCluster has legacy ABAC enabled.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:146
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  119  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"google_container_cluster"[0m [38;5;37m"vulnerable_gke"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  146  [0m[0m[31m[[39m[0m[0m [0m  [38;5;245menable_legacy_abac[0m = [38;5;166mtrue[0m[0m[0m [3m[2m[3m(true)[0m
[0m[90m  ...  [0m
[0m[90m  172  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-gke-use-rbac-permissions
[0m[0m  [2m    Impact[0m ABAC permissions are less secure than RBAC permissions
[0m[0m  [2mResolution[0m Switch to using RBAC permissions
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/gke/use-rbac-permissions/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#enable_legacy_abac[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #15[0m [0m[31mHIGH[39m[0m [1mCluster exposes control plane to the public internet.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:163
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  119  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"google_container_cluster"[0m [38;5;37m"vulnerable_gke"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  163  [0m[0m[31m[[39m[0m[0m       [38;5;245mcidr_block[0m   = [38;5;37m"0.0.0.0/0"[0m
[0m[90m  ...  [0m
[0m[90m  172  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-gke-no-public-control-plane
[0m[0m  [2m    Impact[0m GKE control plane exposed to public internet
[0m[0m  [2mResolution[0m Use private nodes and master authorised networks to prevent exposure
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/gke/no-public-control-plane/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #16[0m [0m[31mHIGH[39m[0m [1mCluster has legacy metadata endpoints enabled.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:181-208
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  175  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"google_container_node_pool"[0m [38;5;37m"vulnerable_nodes"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  181  [0m[0m[31m┌[39m[0m[0m   node_config {[0m
[0m[31m  182  [0m[0m[31m│[39m[0m[0m     [38;5;245mpreemptible[0m  = [38;5;166mfalse[0m
[0m[31m  183  [0m[0m[31m│[39m[0m[0m [0m    [38;5;245mmachine_type[0m = [38;5;37m"e2-medium"[0m[0m
[0m[31m  184  [0m[0m[31m│[39m[0m[0m [38;5;239m[0m
[0m[31m  185  [0m[0m[31m│[39m[0m[0m     # OAuth scopes too broad[0m
[0m[31m  186  [0m[0m[31m│[39m[0m[0m [0m    [38;5;245moauth_scopes[0m = [[0m
[0m[31m  187  [0m[0m[31m└[39m[0m[0m       [38;5;37m"https://www.googleapis.com/auth/cloud-platform"[0m[38;5;239m  # Full access[0m
[0m[90m  ...  [0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-gke-metadata-endpoints-disabled
[0m[0m  [2m    Impact[0m Legacy metadata endpoints don't require metadata headers
[0m[0m  [2mResolution[0m Disable legacy metadata endpoints
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/gke/metadata-endpoints-disabled/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#metadata[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResults #17-18[0m [0m[31mHIGH[39m[0m [1mNode pool exposes node metadata.[0m [2m(2 similar results)[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:181-208
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  175  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"google_container_node_pool"[0m [38;5;37m"vulnerable_nodes"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  181  [0m[0m[31m┌[39m[0m[0m   node_config {[0m
[0m[31m  182  [0m[0m[31m│[39m[0m[0m     [38;5;245mpreemptible[0m  = [38;5;166mfalse[0m
[0m[31m  183  [0m[0m[31m│[39m[0m[0m [0m    [38;5;245mmachine_type[0m = [38;5;37m"e2-medium"[0m[0m
[0m[31m  184  [0m[0m[31m│[39m[0m[0m [38;5;239m[0m
[0m[31m  185  [0m[0m[31m│[39m[0m[0m     # OAuth scopes too broad[0m
[0m[31m  186  [0m[0m[31m│[39m[0m[0m [0m    [38;5;245moauth_scopes[0m = [[0m
[0m[31m  187  [0m[0m[31m└[39m[0m[0m       [38;5;37m"https://www.googleapis.com/auth/cloud-platform"[0m[38;5;239m  # Full access[0m
[0m[90m  ...  [0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2mIndividual Causes
[0m[0m  [2m- [0m[3mkubernetes-clusters.tf[2m[3m:175-221 (google_container_node_pool.vulnerable_nodes)[0m [2m[3m2 instances
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-gke-node-metadata-security
[0m[0m  [2m    Impact[0m Metadata that isn't concealed potentially risks leakage of sensitive data
[0m[0m  [2mResolution[0m Set node metadata to SECURE or GKE_METADATA_SERVER
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/gke/node-metadata-security/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#node_metadata[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #19[0m [0m[31mHIGH[39m[0m [1mCluster does not have secret encryption enabled.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:7-33
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[31m    7  [0m[0m[31m┌[39m[0m[0m [0m[38;5;33mresource[0m [38;5;37m"aws_eks_cluster"[0m [38;5;37m"vulnerable_cluster"[0m {[0m
[0m[31m    8  [0m[0m[31m│[39m[0m[0m   [38;5;245mname[0m     = [38;5;37m"vulnerable-eks"[0m
[0m[31m    9  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mrole_arn[0m = aws_iam_role.eks_cluster_role.arn[0m
[0m[31m   10  [0m[0m[31m│[39m[0m[0m   [38;5;245mversion[0m  = [38;5;37m"1.18"[0m[38;5;239m  # Outdated version[0m
[0m[31m   11  [0m[0m[31m│[39m[0m[0m [0m
[0m[31m   12  [0m[0m[31m│[39m[0m[0m [0m  vpc_config {[0m
[0m[31m   13  [0m[0m[31m│[39m[0m[0m     [38;5;245msubnet_ids[0m              = [aws_subnet.public_subnet.id][38;5;239m  # Public subnets only[0m
[0m[31m   14  [0m[0m[31m│[39m[0m[0m [0m    [38;5;245mendpoint_private_access[0m = [38;5;166mfalse[0m
[0m[31m   15  [0m[0m[31m└[39m[0m[0m [0m    [38;5;245mendpoint_public_access[0m  = [38;5;166mtrue[0m
[0m[90m   ..  [0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-eks-encrypt-secrets
[0m[0m  [2m    Impact[0m EKS secrets could be read if compromised
[0m[0m  [2mResolution[0m Enable encryption of EKS secrets
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/eks/encrypt-secrets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#encryption_config[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #20[0m [0m[31mHIGH[39m[0m [1mKubernetes cluster does not have a network policy set.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:91
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m   63  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"azurerm_kubernetes_cluster"[0m [38;5;37m"vulnerable_aks"[0m {[0m
[0m[90m   ..  [0m
[0m[31m   91  [0m[0m[31m[[39m[0m[0m [0m    [38;5;245mnetwork_policy[0m     = [38;5;37m""[0m[38;5;239m  # No network policy[0m[0m [3m[3m[2m("")[0m
[0m[90m  ...  [0m
[0m[90m  116  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m azure-container-configured-network-policy
[0m[0m  [2m    Impact[0m No network policy is protecting the AKS cluster
[0m[0m  [2mResolution[0m Configure a network policy
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/azure/container/configured-network-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#network_policy[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #21[0m [0m[31mHIGH[39m[0m [1mCluster has RBAC disabled[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:99
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m   63  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"azurerm_kubernetes_cluster"[0m [38;5;37m"vulnerable_aks"[0m {[0m
[0m[90m   ..  [0m
[0m[31m   99  [0m[0m[31m[[39m[0m[0m     [38;5;245menabled[0m = [38;5;166mfalse[0m[38;5;239m  # RBAC disabled[0m[0m [3m[2m[3m(false)[0m
[0m[90m  ...  [0m
[0m[90m  116  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m azure-container-use-rbac-permissions
[0m[0m  [2m    Impact[0m No role based access control is in place for the AKS cluster
[0m[0m  [2mResolution[0m Enable RBAC
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/azure/container/use-rbac-permissions/[0m[0m
  [2m-[0m [34mhttps://www.terraform.io/docs/providers/azurerm/r/kubernetes_cluster.html#role_based_access_control[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #22[0m [0m[31mHIGH[39m[0m [1mRoot block device is not encrypted.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:112
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m   98  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_instance"[0m [38;5;37m"vulnerable_instance"[0m {[0m
[0m[90m   ..  [0m
[0m[31m  112  [0m[0m[31m[[39m[0m[0m [0m    [38;5;245mencrypted[0m   = [38;5;166mfalse[0m[0m [3m[2m[3m(false)[0m
[0m[90m  ...  [0m
[0m[90m  152  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-enable-at-rest-encryption
[0m[0m  [2m    Impact[0m The block device could be compromised and read from
[0m[0m  [2mResolution[0m Turn on encryption for all block devices
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #23[0m [0m[31mHIGH[39m[0m [1mInstance has Public Access enabled[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:224
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[31m  224  [0m[0m [0m[0m [0m  [38;5;245mpublicly_accessible[0m = [38;5;166mtrue[0m[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2mRego Package[0m[3m builtin.aws.rds.aws0180
[0m[0m  [2m   Rego Rule[0m[3m deny[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #24[0m [0m[31mHIGH[39m[0m [1mInstance does not have storage encryption enabled.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:227
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  208  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"vulnerable_db"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  227  [0m[0m[31m[[39m[0m[0m [0m  [38;5;245mstorage_encrypted[0m = [38;5;166mfalse[0m[0m[0m [3m[2m[3m(false)[0m
[0m[90m  ...  [0m
[0m[90m  253  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-rds-encrypt-instance-storage-data
[0m[0m  [2m    Impact[0m Data can be read from RDS instances if compromised
[0m[0m  [2mResolution[0m Enable encryption for RDS instances
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/encrypt-instance-storage-data/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #25[0m [0m[31mHIGH[39m[0m [1mAccount does not enforce HTTPS.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:282
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  270  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"azurerm_storage_account"[0m [38;5;37m"vulnerable_storage"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  282  [0m[0m[31m[[39m[0m[0m [0m  [38;5;245menable_https_traffic_only[0m = [38;5;166mfalse[0m[0m[0m [3m[2m[3m(false)[0m
[0m[90m  ...  [0m
[0m[90m  297  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m azure-storage-enforce-https
[0m[0m  [2m    Impact[0m Insecure transfer of data into secure accounts could be read if intercepted
[0m[0m  [2mResolution[0m Only allow secure connection for transferring data into storage accounts
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/azure/storage/enforce-https/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#enable_https_traffic_only[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #26[0m [0m[31mHIGH[39m[0m [1mInstance has a public IP allocated.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:319-321
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  302  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"google_compute_instance"[0m [38;5;37m"vulnerable_vm"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  319  [0m[0m[31m┌[39m[0m[0m [0m    access_config {[0m
[0m[31m  320  [0m[0m[31m│[39m[0m[0m [38;5;239m      // Ephemeral IP[0m
[0m[31m  321  [0m[0m[31m└[39m[0m[0m [0m    }[0m
[0m[90m  ...  [0m
[0m[90m  353  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-compute-no-public-ip
[0m[0m  [2m    Impact[0m Direct exposure of an instance to the public internet
[0m[0m  [2mResolution[0m Remove public IP
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/compute/no-public-ip/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#access_config[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #27[0m [0m[31mHIGH[39m[0m [1mPublic access block does not block public ACLs[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:72
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m   69  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_s3_bucket_public_access_block"[0m [38;5;37m"vulnerable_bucket_pab"[0m {[0m
[0m[90m   70  [0m[0m    [38;5;245mbucket[0m = aws_s3_bucket.vulnerable_bucket.id[0m
[0m[90m   71  [0m[0m  [0m
[0m[31m   72  [0m[0m[31m[[39m[0m[0m   [38;5;245mblock_public_acls[0m       = [38;5;166mfalse[0m[0m [3m[2m[3m(false)[0m
[0m[90m   73  [0m[0m  [0m  [38;5;245mblock_public_policy[0m     = [38;5;166mfalse[0m
[0m[90m   74  [0m[0m  [0m  [38;5;245mignore_public_acls[0m      = [38;5;166mfalse[0m
[0m[90m   75  [0m[0m  [0m  [38;5;245mrestrict_public_buckets[0m = [38;5;166mfalse[0m
[0m[90m   76  [0m[0m  [0m}[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #28[0m [0m[31mHIGH[39m[0m [1mPublic access block does not block public policies[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:73
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m   69  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_s3_bucket_public_access_block"[0m [38;5;37m"vulnerable_bucket_pab"[0m {[0m
[0m[90m   70  [0m[0m    [38;5;245mbucket[0m = aws_s3_bucket.vulnerable_bucket.id[0m
[0m[90m   71  [0m[0m  [0m
[0m[90m   72  [0m[0m    [38;5;245mblock_public_acls[0m       = [38;5;166mfalse[0m
[0m[31m   73  [0m[0m[31m[[39m[0m[0m [0m  [38;5;245mblock_public_policy[0m     = [38;5;166mfalse[0m[0m [3m[2m[3m(false)[0m
[0m[90m   74  [0m[0m  [0m  [38;5;245mignore_public_acls[0m      = [38;5;166mfalse[0m
[0m[90m   75  [0m[0m  [0m  [38;5;245mrestrict_public_buckets[0m = [38;5;166mfalse[0m
[0m[90m   76  [0m[0m  [0m}[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #29[0m [0m[31mHIGH[39m[0m [1mPublic access block does not ignore public ACLs[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:74
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m   69  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_s3_bucket_public_access_block"[0m [38;5;37m"vulnerable_bucket_pab"[0m {[0m
[0m[90m   70  [0m[0m    [38;5;245mbucket[0m = aws_s3_bucket.vulnerable_bucket.id[0m
[0m[90m   71  [0m[0m  [0m
[0m[90m   72  [0m[0m    [38;5;245mblock_public_acls[0m       = [38;5;166mfalse[0m
[0m[90m   73  [0m[0m  [0m  [38;5;245mblock_public_policy[0m     = [38;5;166mfalse[0m
[0m[31m   74  [0m[0m[31m[[39m[0m[0m [0m  [38;5;245mignore_public_acls[0m      = [38;5;166mfalse[0m[0m [3m[3m[2m(false)[0m
[0m[90m   75  [0m[0m  [0m  [38;5;245mrestrict_public_buckets[0m = [38;5;166mfalse[0m
[0m[90m   76  [0m[0m  [0m}[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #30[0m [0m[31mHIGH[39m[0m [1mPublic access block does not restrict public buckets[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:75
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m   69  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_s3_bucket_public_access_block"[0m [38;5;37m"vulnerable_bucket_pab"[0m {[0m
[0m[90m   70  [0m[0m    [38;5;245mbucket[0m = aws_s3_bucket.vulnerable_bucket.id[0m
[0m[90m   71  [0m[0m  [0m
[0m[90m   72  [0m[0m    [38;5;245mblock_public_acls[0m       = [38;5;166mfalse[0m
[0m[90m   73  [0m[0m  [0m  [38;5;245mblock_public_policy[0m     = [38;5;166mfalse[0m
[0m[90m   74  [0m[0m  [0m  [38;5;245mignore_public_acls[0m      = [38;5;166mfalse[0m
[0m[31m   75  [0m[0m[31m[[39m[0m[0m [0m  [38;5;245mrestrict_public_buckets[0m = [38;5;166mfalse[0m[0m [3m[2m[3m(false)[0m
[0m[90m   76  [0m[0m  [0m}[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets¡[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #31[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:87-95
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[31m   87  [0m[0m [0m[0m [0m[38;5;33mresource[0m [38;5;37m"aws_s3_bucket_server_side_encryption_configuration"[0m [38;5;37m"vulnerable_bucket_encryption"[0m {[0m
[0m[31m   88  [0m[0m [0m[0m   [38;5;245mbucket[0m = aws_s3_bucket.vulnerable_bucket.id[0m
[0m[31m   89  [0m[0m [0m[0m [0m
[0m[31m   90  [0m[0m [0m[0m   rule {[0m
[0m[31m   91  [0m[0m [0m[0m     apply_server_side_encryption_by_default {[0m
[0m[31m   92  [0m[0m [0m[0m       [38;5;245msse_algorithm[0m = [38;5;37m"AES256"[0m[38;5;239m  # Issue: Not using KMS[0m
[0m[31m   93  [0m[0m [0m[0m [0m    }[0m
[0m[31m   94  [0m[0m [0m[0m   }[0m
[0m[31m   95  [0m[0m [0m[0m }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #32[0m [0m[31mHIGH[39m[0m [1mInstance does not require IMDS access to require a token[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:98-152
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[31m   98  [0m[0m[31m┌[39m[0m[0m [0m[38;5;33mresource[0m [38;5;37m"aws_instance"[0m [38;5;37m"vulnerable_instance"[0m {[0m
[0m[31m   99  [0m[0m[31m│[39m[0m[0m   [38;5;245mami[0m           = [38;5;37m"ami-0c02fb55956c7d316"[0m[38;5;239m  # Issue: Hardcoded AMI ID[0m
[0m[31m  100  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245minstance_type[0m = [38;5;37m"t3.large"[0m[38;5;239m               # Issue: Oversized for demo[0m
[0m[31m  101  [0m[0m[31m│[39m[0m[0m [0m
[0m[31m  102  [0m[0m[31m│[39m[0m[0m   # Issue: No key pair specified[0m
[0m[31m  103  [0m[0m[31m│[39m[0m[0m   # key_name = aws_key_pair.main.key_name[0m
[0m[31m  104  [0m[0m[31m│[39m[0m[0m [0m
[0m[31m  105  [0m[0m[31m│[39m[0m[0m   # Issue: Security group allows all traffic[0m
[0m[31m  106  [0m[0m[31m└[39m[0m[0m [0m  [38;5;245mvpc_security_group_ids[0m = [aws_security_group.vulnerable_sg.id][0m
[0m[90m  ...  [0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-enforce-http-token-imds
[0m[0m  [2m    Impact[0m Instance metadata service can be interacted with freely
[0m[0m  [2mResolution[0m Enable HTTP token requirement for IMDS
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #33[0m [0m[33mMEDIUM[39m[0m [1mCluster does not have a network policy enabled.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:150
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  119  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"google_container_cluster"[0m [38;5;37m"vulnerable_gke"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  150  [0m[0m[31m[[39m[0m[0m     [38;5;245menabled[0m  = [38;5;166mfalse[0m[0m [3m[3m[2m(false)[0m
[0m[90m  ...  [0m
[0m[90m  172  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-gke-enable-network-policy
[0m[0m  [2m    Impact[0m Unrestricted inter-cluster communication
[0m[0m  [2mResolution[0m Enable network policy
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/gke/enable-network-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#enabled[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #34[0m [0m[33mMEDIUM[39m[0m [1mCluster does not have private nodes.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:156
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  119  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"google_container_cluster"[0m [38;5;37m"vulnerable_gke"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  156  [0m[0m[31m[[39m[0m[0m     [38;5;245menable_private_nodes[0m    = [38;5;166mfalse[0m[0m [3m[3m[2m(false)[0m
[0m[90m  ...  [0m
[0m[90m  172  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-gke-enable-private-cluster
[0m[0m  [2m    Impact[0m Nodes may be exposed to the public internet
[0m[0m  [2mResolution[0m Enable private cluster
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/gke/enable-private-cluster/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#enable_private_nodes[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #35[0m [0m[33mMEDIUM[39m[0m [1mCluster does not have logging enabled via OMS Agent.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:63-116
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[31m   63  [0m[0m[31m┌[39m[0m[0m [0m[38;5;33mresource[0m [38;5;37m"azurerm_kubernetes_cluster"[0m [38;5;37m"vulnerable_aks"[0m {[0m
[0m[31m   64  [0m[0m[31m│[39m[0m[0m   [38;5;245mname[0m                = [38;5;37m"vulnerable-aks"[0m
[0m[31m   65  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mlocation[0m            = azurerm_resource_group.main.location[0m
[0m[31m   66  [0m[0m[31m│[39m[0m[0m   [38;5;245mresource_group_name[0m = azurerm_resource_group.main.name[0m
[0m[31m   67  [0m[0m[31m│[39m[0m[0m   [38;5;245mdns_prefix[0m          = [38;5;37m"vulnerable-aks"[0m
[0m[31m   68  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mkubernetes_version[0m  = [38;5;37m"1.19.0"[0m[38;5;239m  # Outdated version[0m
[0m[31m   69  [0m[0m[31m│[39m[0m[0m [0m
[0m[31m   70  [0m[0m[31m│[39m[0m[0m [0m  default_node_pool {[0m
[0m[31m   71  [0m[0m[31m└[39m[0m[0m     [38;5;245mname[0m       = [38;5;37m"default"[0m
[0m[90m   ..  [0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m azure-container-logging
[0m[0m  [2m    Impact[0m Logging provides valuable information about access and usage
[0m[0m  [2mResolution[0m Enable logging for AKS
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/azure/container/logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#oms_agent[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResults #36-40[0m [0m[33mMEDIUM[39m[0m [1mControl plane controller manager logging is not enabled.[0m [2m(5 similar results)[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:7-33
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[31m    7  [0m[0m[31m┌[39m[0m[0m [0m[38;5;33mresource[0m [38;5;37m"aws_eks_cluster"[0m [38;5;37m"vulnerable_cluster"[0m {[0m
[0m[31m    8  [0m[0m[31m│[39m[0m[0m   [38;5;245mname[0m     = [38;5;37m"vulnerable-eks"[0m
[0m[31m    9  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mrole_arn[0m = aws_iam_role.eks_cluster_role.arn[0m
[0m[31m   10  [0m[0m[31m│[39m[0m[0m   [38;5;245mversion[0m  = [38;5;37m"1.18"[0m[38;5;239m  # Outdated version[0m
[0m[31m   11  [0m[0m[31m│[39m[0m[0m [0m
[0m[31m   12  [0m[0m[31m│[39m[0m[0m [0m  vpc_config {[0m
[0m[31m   13  [0m[0m[31m│[39m[0m[0m     [38;5;245msubnet_ids[0m              = [aws_subnet.public_subnet.id][38;5;239m  # Public subnets only[0m
[0m[31m   14  [0m[0m[31m│[39m[0m[0m [0m    [38;5;245mendpoint_private_access[0m = [38;5;166mfalse[0m
[0m[31m   15  [0m[0m[31m└[39m[0m[0m [0m    [38;5;245mendpoint_public_access[0m  = [38;5;166mtrue[0m
[0m[90m   ..  [0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2mIndividual Causes
[0m[0m  [2m- [0m[3mkubernetes-clusters.tf[2m[3m:7-33 (aws_eks_cluster.vulnerable_cluster)[0m [3m[2m3 instances
[0m[0m  [2m- [0m[3mkubernetes-clusters.tf[3m[2m:7-33 (aws_eks_cluster.vulnerable_cluster)[0m [2m[3m2 instances
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-eks-enable-control-plane-logging
[0m[0m  [2m    Impact[0m Logging provides valuable information about access and usage
[0m[0m  [2mResolution[0m Enable logging for the EKS control plane
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/eks/enable-control-plane-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#enabled_cluster_log_types[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #41[0m [0m[33mMEDIUM[39m[0m [1mInstance does not have IAM Authentication enabled[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:208-253
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[31m  208  [0m[0m[31m┌[39m[0m[0m [0m[38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"vulnerable_db"[0m {[0m
[0m[31m  209  [0m[0m[31m│[39m[0m[0m   [38;5;245midentifier[0m = [38;5;37m"vulnerable-database"[0m
[0m[31m  210  [0m[0m[31m│[39m[0m[0m [0m  [0m
[0m[31m  211  [0m[0m[31m│[39m[0m[0m   [38;5;245mengine[0m         = [38;5;37m"mysql"[0m
[0m[31m  212  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mengine_version[0m = [38;5;37m"5.7"[0m[38;5;239m  # Issue: Outdated version[0m
[0m[31m  213  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245minstance_class[0m = [38;5;37m"db.t3.micro"[0m
[0m[31m  214  [0m[0m[31m│[39m[0m[0m [0m  [0m
[0m[31m  215  [0m[0m[31m│[39m[0m[0m   [38;5;245mallocated_storage[0m     = [38;5;37m20[0m
[0m[31m  216  [0m[0m[31m└[39m[0m[0m [0m  [38;5;245mmax_allocated_storage[0m = [38;5;37m100[0m[0m
[0m[90m  ...  [0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2mRego Package[0m[3m builtin.aws.rds.aws0176
[0m[0m  [2m   Rego Rule[0m[3m deny[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #42[0m [0m[33mMEDIUM[39m[0m [1mInstance has very low backup retention period.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[3m[2m:230
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  208  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"vulnerable_db"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  230  [0m[0m[31m[[39m[0m[0m [0m  [38;5;245mbackup_retention_period[0m = [38;5;37m1[0m[0m [3m[2m[3m(1)[0m
[0m[90m  ...  [0m
[0m[90m  253  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-rds-specify-backup-retention
[0m[0m  [2m    Impact[0m Potential loss of data and short opportunity for recovery
[0m[0m  [2mResolution[0m Explicitly set the retention period to greater than the default
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/specify-backup-retention/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster#backup_retention_period[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#backup_retention_period[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #43[0m [0m[33mMEDIUM[39m[0m [1mInstance does not have Deletion Protection enabled[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:237
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[31m  237  [0m[0m [0m[0m [0m  [38;5;245mdeletion_protection[0m = [38;5;166mfalse[0m[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2mRego Package[0m[3m builtin.aws.rds.aws0177
[0m[0m  [2m   Rego Rule[0m[3m deny[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #44[0m [0m[33mMEDIUM[39m[0m [1mInstance allows use of project-level SSH keys.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[3m[2m:302-353
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[31m  302  [0m[0m[31m┌[39m[0m[0m [0m[38;5;33mresource[0m [38;5;37m"google_compute_instance"[0m [38;5;37m"vulnerable_vm"[0m {[0m
[0m[31m  303  [0m[0m[31m│[39m[0m[0m   [38;5;245mname[0m         = [38;5;37m"vulnerable-vm"[0m
[0m[31m  304  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mmachine_type[0m = [38;5;37m"e2-medium"[0m
[0m[31m  305  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mzone[0m         = [38;5;33mvar[0m.gcp_zone[0m
[0m[31m  306  [0m[0m[31m│[39m[0m[0m   [0m
[0m[31m  307  [0m[0m[31m│[39m[0m[0m   boot_disk {[0m
[0m[31m  308  [0m[0m[31m│[39m[0m[0m     initialize_params {[0m
[0m[31m  309  [0m[0m[31m│[39m[0m[0m       [38;5;245mimage[0m = [38;5;37m"debian-cloud/debian-11"[0m
[0m[31m  310  [0m[0m[31m└[39m[0m[0m [0m      [38;5;245msize[0m  = [38;5;37m20[0m
[0m[90m  ...  [0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-compute-no-project-wide-ssh-keys
[0m[0m  [2m    Impact[0m Compromise of a single key pair compromises all instances
[0m[0m  [2mResolution[0m Disable project-wide SSH keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/compute/no-project-wide-ssh-keys/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #45[0m [0m[33mMEDIUM[39m[0m [1mInstance does not have VTPM for shielded VMs enabled.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:302-353
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[31m  302  [0m[0m[31m┌[39m[0m[0m [0m[38;5;33mresource[0m [38;5;37m"google_compute_instance"[0m [38;5;37m"vulnerable_vm"[0m {[0m
[0m[31m  303  [0m[0m[31m│[39m[0m[0m   [38;5;245mname[0m         = [38;5;37m"vulnerable-vm"[0m
[0m[31m  304  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mmachine_type[0m = [38;5;37m"e2-medium"[0m
[0m[31m  305  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mzone[0m         = [38;5;33mvar[0m.gcp_zone[0m
[0m[31m  306  [0m[0m[31m│[39m[0m[0m   [0m
[0m[31m  307  [0m[0m[31m│[39m[0m[0m   boot_disk {[0m
[0m[31m  308  [0m[0m[31m│[39m[0m[0m     initialize_params {[0m
[0m[31m  309  [0m[0m[31m│[39m[0m[0m       [38;5;245mimage[0m = [38;5;37m"debian-cloud/debian-11"[0m
[0m[31m  310  [0m[0m[31m└[39m[0m[0m [0m      [38;5;245msize[0m  = [38;5;37m20[0m
[0m[90m  ...  [0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-compute-enable-shielded-vm-vtpm
[0m[0m  [2m    Impact[0m Unable to prevent unwanted system state modification
[0m[0m  [2mResolution[0m Enable Shielded VM VTPM
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/compute/enable-shielded-vm-vtpm/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#enable_vtpm[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #46[0m [0m[33mMEDIUM[39m[0m [1mInstance does not have shielded VM integrity monitoring enabled.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:302-353
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[31m  302  [0m[0m[31m┌[39m[0m[0m [0m[38;5;33mresource[0m [38;5;37m"google_compute_instance"[0m [38;5;37m"vulnerable_vm"[0m {[0m
[0m[31m  303  [0m[0m[31m│[39m[0m[0m   [38;5;245mname[0m         = [38;5;37m"vulnerable-vm"[0m
[0m[31m  304  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mmachine_type[0m = [38;5;37m"e2-medium"[0m
[0m[31m  305  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mzone[0m         = [38;5;33mvar[0m.gcp_zone[0m
[0m[31m  306  [0m[0m[31m│[39m[0m[0m   [0m
[0m[31m  307  [0m[0m[31m│[39m[0m[0m   boot_disk {[0m
[0m[31m  308  [0m[0m[31m│[39m[0m[0m     initialize_params {[0m
[0m[31m  309  [0m[0m[31m│[39m[0m[0m       [38;5;245mimage[0m = [38;5;37m"debian-cloud/debian-11"[0m
[0m[31m  310  [0m[0m[31m└[39m[0m[0m [0m      [38;5;245msize[0m  = [38;5;37m20[0m
[0m[90m  ...  [0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-compute-enable-shielded-vm-im
[0m[0m  [2m    Impact[0m No visibility of VM instance boot state.
[0m[0m  [2mResolution[0m Enable Shielded VM Integrity Monitoring
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/compute/enable-shielded-vm-im/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#enable_vtpm[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #47[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:57-66
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[31m   57  [0m[0m [0m[0m [0m[38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"vulnerable_bucket"[0m {[0m
[0m[31m   58  [0m[0m [0m[0m   [38;5;245mbucket[0m = [38;5;37m"my-super-secret-company-data-[0m[38;5;37m${[0mrandom_string.bucket_suffix.result[38;5;37m}[0m[38;5;37m"[0m
[0m[31m   59  [0m[0m [0m[0m [0m  [0m
[0m[31m   60  [0m[0m [0m[0m   [38;5;245mtags[0m = {[0m
[0m[31m   61  [0m[0m [0m[0m     [38;5;245mEnvironment[0m = [38;5;37m"production"[0m[0m
[0m[31m   62  [0m[0m [0m[0m [38;5;239m    # Issue: Sensitive information in tags[0m
[0m[31m   63  [0m[0m [0m[0m [0m    [38;5;245mDatabasePassword[0m = [38;5;37m"admin123"[0m
[0m[31m   64  [0m[0m [0m[0m [0m    [38;5;245mApiKey[0m          = [38;5;33mvar[0m.api_key[0m
[0m[31m   65  [0m[0m [0m[0m   }[0m
[0m[31m   66  [0m[0m [0m[0m }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #48[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:82
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m   79  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_s3_bucket_versioning"[0m [38;5;37m"vulnerable_bucket_versioning"[0m {[0m
[0m[90m   80  [0m[0m    [38;5;245mbucket[0m = aws_s3_bucket.vulnerable_bucket.id[0m
[0m[90m   81  [0m[0m    versioning_configuration {[0m
[0m[31m   82  [0m[0m[31m[[39m[0m[0m     [38;5;245mstatus[0m = [38;5;37m"Disabled"[0m
[0m[90m   83  [0m[0m  [0m  }[0m
[0m[90m   84  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #49[0m [0m[97mLOW[39m[0m [1mCluster has IP aliasing disabled.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:119-172
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[31m  119  [0m[0m[31m┌[39m[0m[0m [0m[38;5;33mresource[0m [38;5;37m"google_container_cluster"[0m [38;5;37m"vulnerable_gke"[0m {[0m
[0m[31m  120  [0m[0m[31m│[39m[0m[0m   [38;5;245mname[0m     = [38;5;37m"vulnerable-gke"[0m
[0m[31m  121  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mlocation[0m = [38;5;37m"us-central1-a"[0m[0m
[0m[31m  122  [0m[0m[31m│[39m[0m[0m [38;5;239m  [0m
[0m[31m  123  [0m[0m[31m│[39m[0m[0m   # Remove default node pool immediately[0m
[0m[31m  124  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mremove_default_node_pool[0m = [38;5;166mtrue[0m
[0m[31m  125  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245minitial_node_count[0m       = [38;5;37m1[0m[0m
[0m[31m  126  [0m[0m[31m│[39m[0m[0m [38;5;239m[0m
[0m[31m  127  [0m[0m[31m└[39m[0m[0m   # Network configuration with issues[0m
[0m[90m  ...  [0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-gke-enable-ip-aliasing
[0m[0m  [2m    Impact[0m Nodes need a NAT gateway to access local services
[0m[0m  [2mResolution[0m Enable IP aliasing
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/gke/enable-ip-aliasing/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#ip_allocation_policy[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #50[0m [0m[97mLOW[39m[0m [1mCluster does not use GCE resource labels.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:119-172
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[31m  119  [0m[0m[31m┌[39m[0m[0m [0m[38;5;33mresource[0m [38;5;37m"google_container_cluster"[0m [38;5;37m"vulnerable_gke"[0m {[0m
[0m[31m  120  [0m[0m[31m│[39m[0m[0m   [38;5;245mname[0m     = [38;5;37m"vulnerable-gke"[0m
[0m[31m  121  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mlocation[0m = [38;5;37m"us-central1-a"[0m[0m
[0m[31m  122  [0m[0m[31m│[39m[0m[0m [38;5;239m  [0m
[0m[31m  123  [0m[0m[31m│[39m[0m[0m   # Remove default node pool immediately[0m
[0m[31m  124  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mremove_default_node_pool[0m = [38;5;166mtrue[0m
[0m[31m  125  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245minitial_node_count[0m       = [38;5;37m1[0m[0m
[0m[31m  126  [0m[0m[31m│[39m[0m[0m [38;5;239m[0m
[0m[31m  127  [0m[0m[31m└[39m[0m[0m   # Network configuration with issues[0m
[0m[90m  ...  [0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-gke-use-cluster-labels
[0m[0m  [2m    Impact[0m Asset management can be limited/more difficult
[0m[0m  [2mResolution[0m Set cluster resource labels
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/gke/use-cluster-labels/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#resource_labels[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #51[0m [0m[97mLOW[39m[0m [1mCluster does not use the logging.googleapis.com/kubernetes StackDriver logging service.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:142
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  119  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"google_container_cluster"[0m [38;5;37m"vulnerable_gke"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  142  [0m[0m[31m[[39m[0m[0m [0m  [38;5;245mlogging_service[0m    = [38;5;37m"none"[0m[0m [3m[2m[3m("none")[0m
[0m[90m  ...  [0m
[0m[90m  172  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-gke-enable-stackdriver-logging
[0m[0m  [2m    Impact[0m Visibility will be reduced
[0m[0m  [2mResolution[0m Enable StackDriver logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/gke/enable-stackdriver-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#logging_service[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #52[0m [0m[97mLOW[39m[0m [1mCluster does not use the monitoring.googleapis.com/kubernetes StackDriver monitoring service.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:143
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  119  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"google_container_cluster"[0m [38;5;37m"vulnerable_gke"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  143  [0m[0m[31m[[39m[0m[0m [0m  [38;5;245mmonitoring_service[0m = [38;5;37m"none"[0m[0m[0m [3m[2m[3m("none")[0m
[0m[90m  ...  [0m
[0m[90m  172  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-gke-enable-stackdriver-monitoring
[0m[0m  [2m    Impact[0m Visibility will be reduced
[0m[0m  [2mResolution[0m Enable StackDriver monitoring
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/gke/enable-stackdriver-monitoring/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#monitoring_service[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #53[0m [0m[97mLOW[39m[0m [1mNode pool is not using the COS containerd image type.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:181-208
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  175  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"google_container_node_pool"[0m [38;5;37m"vulnerable_nodes"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  181  [0m[0m[31m┌[39m[0m[0m   node_config {[0m
[0m[31m  182  [0m[0m[31m│[39m[0m[0m     [38;5;245mpreemptible[0m  = [38;5;166mfalse[0m
[0m[31m  183  [0m[0m[31m│[39m[0m[0m [0m    [38;5;245mmachine_type[0m = [38;5;37m"e2-medium"[0m[0m
[0m[31m  184  [0m[0m[31m│[39m[0m[0m [38;5;239m[0m
[0m[31m  185  [0m[0m[31m│[39m[0m[0m     # OAuth scopes too broad[0m
[0m[31m  186  [0m[0m[31m│[39m[0m[0m [0m    [38;5;245moauth_scopes[0m = [[0m
[0m[31m  187  [0m[0m[31m└[39m[0m[0m       [38;5;37m"https://www.googleapis.com/auth/cloud-platform"[0m[38;5;239m  # Full access[0m
[0m[90m  ...  [0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-gke-node-pool-uses-cos
[0m[0m  [2m    Impact[0m COS is the recommended OS image to use on cluster nodes
[0m[0m  [2mResolution[0m Use the COS image type
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/gke/node-pool-uses-cos/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#image_type[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #54[0m [0m[97mLOW[39m[0m [1mNode pool does not have auto-repair enabled.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[3m[2m:212
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  175  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"google_container_node_pool"[0m [38;5;37m"vulnerable_nodes"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  212  [0m[0m[31m[[39m[0m[0m     [38;5;245mauto_repair[0m  = [38;5;166mfalse[0m[0m [3m[2m[3m(false)[0m
[0m[90m  ...  [0m
[0m[90m  221  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-gke-enable-auto-repair
[0m[0m  [2m    Impact[0m Failing nodes will require manual repair.
[0m[0m  [2mResolution[0m Enable automatic repair
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/gke/enable-auto-repair/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#auto_repair[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #55[0m [0m[97mLOW[39m[0m [1mNode pool does not have auto-upgraade enabled.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mkubernetes-clusters.tf[2m[3m:213
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  175  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"google_container_node_pool"[0m [38;5;37m"vulnerable_nodes"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  213  [0m[0m[31m[[39m[0m[0m [0m    [38;5;245mauto_upgrade[0m = [38;5;166mfalse[0m[0m [3m[3m[2m(false)[0m
[0m[90m  ...  [0m
[0m[90m  221  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-gke-enable-auto-upgrade
[0m[0m  [2m    Impact[0m Nodes will need the cluster master version manually updating
[0m[0m  [2mResolution[0m Enable automatic upgrades
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/gke/enable-auto-upgrade/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#auto_upgrade[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #56[0m [0m[97mLOW[39m[0m [1mSecurity group rule does not have a description.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:195-200
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  155  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"vulnerable_sg"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  195  [0m[0m[31m┌[39m[0m[0m [0m  egress {[0m
[0m[31m  196  [0m[0m[31m│[39m[0m[0m     [38;5;245mfrom_port[0m   = [38;5;37m0[0m
[0m[31m  197  [0m[0m[31m│[39m[0m[0m [0m    [38;5;245mto_port[0m     = [38;5;37m0[0m
[0m[31m  198  [0m[0m[31m│[39m[0m[0m [0m    [38;5;245mprotocol[0m    = [38;5;37m"-1"[0m
[0m[31m  199  [0m[0m[31m│[39m[0m[0m [0m    [38;5;245mcidr_blocks[0m = [[38;5;37m"0.0.0.0/0"[0m][0m
[0m[31m  200  [0m[0m[31m└[39m[0m[0m   }[0m
[0m[90m  ...  [0m
[0m[90m  205  [0m[0m  }[0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-add-description-to-security-group-rule
[0m[0m  [2m    Impact[0m Descriptions provide context for the firewall rule reasons
[0m[0m  [2mResolution[0m Add descriptions for all security groups rules
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #57[0m [0m[97mLOW[39m[0m [1mInstance does not have performance insights enabled.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:208-253
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[31m  208  [0m[0m[31m┌[39m[0m[0m [0m[38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"vulnerable_db"[0m {[0m
[0m[31m  209  [0m[0m[31m│[39m[0m[0m   [38;5;245midentifier[0m = [38;5;37m"vulnerable-database"[0m
[0m[31m  210  [0m[0m[31m│[39m[0m[0m [0m  [0m
[0m[31m  211  [0m[0m[31m│[39m[0m[0m   [38;5;245mengine[0m         = [38;5;37m"mysql"[0m
[0m[31m  212  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245mengine_version[0m = [38;5;37m"5.7"[0m[38;5;239m  # Issue: Outdated version[0m
[0m[31m  213  [0m[0m[31m│[39m[0m[0m [0m  [38;5;245minstance_class[0m = [38;5;37m"db.t3.micro"[0m
[0m[31m  214  [0m[0m[31m│[39m[0m[0m [0m  [0m
[0m[31m  215  [0m[0m[31m│[39m[0m[0m   [38;5;245mallocated_storage[0m     = [38;5;37m20[0m
[0m[31m  216  [0m[0m[31m└[39m[0m[0m [0m  [38;5;245mmax_allocated_storage[0m = [38;5;37m100[0m[0m
[0m[90m  ...  [0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m aws-rds-enable-performance-insights
[0m[0m  [2m    Impact[0m Without adequate monitoring, performance related issues may go unreported and potentially lead to compromise.
[0m[0m  [2mResolution[0m Enable performance insights
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/enable-performance-insights/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m[3mResult #58[0m [0m[97mLOW[39m[0m [1mInstance disk encryption does not use a customer managed key.[0m [2m[0m
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[0m[0m  [3mmain.tf[2m[3m:307-314
[0m[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m[90m  302  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"google_compute_instance"[0m [38;5;37m"vulnerable_vm"[0m {[0m
[0m[90m  ...  [0m
[0m[31m  307  [0m[0m[31m┌[39m[0m[0m   boot_disk {[0m
[0m[31m  308  [0m[0m[31m│[39m[0m[0m     initialize_params {[0m
[0m[31m  309  [0m[0m[31m│[39m[0m[0m       [38;5;245mimage[0m = [38;5;37m"debian-cloud/debian-11"[0m
[0m[31m  310  [0m[0m[31m│[39m[0m[0m [0m      [38;5;245msize[0m  = [38;5;37m20[0m
[0m[31m  311  [0m[0m[31m│[39m[0m[0m [0m      [38;5;245mtype[0m  = [38;5;37m"pd-standard"[0m[0m
[0m[31m  312  [0m[0m[31m│[39m[0m[0m [38;5;239m      # Issue: No disk encryption with customer-managed keys[0m
[0m[31m  313  [0m[0m[31m└[39m[0m[0m [0m    }[0m
[0m[90m  ...  [0m
[0m[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m
[0m[0m  [2m        ID[0m[3m google-compute-vm-disk-encryption-customer-key
[0m[0m  [2m    Impact[0m Using unmanaged keys does not allow for proper management
[0m[0m  [2mResolution[0m Use managed keys 
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/google/compute/vm-disk-encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#kms_key_self_link[0m[0m
[90m─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[39m


[0m[0m  [1mtimings[0m
  ──────────────────────────────────────────
[0m[0m  [2mdisk i/o            [0m 10.291308ms
[0m[0m  [2mparsing             [0m 3.323993ms
[0m[0m  [2madaptation          [0m 275.783µs
[0m[0m  [2mchecks              [0m 16.141202ms
[0m[0m  [2mtotal               [0m 30.032286ms
[0m
[0m  [1mcounts[0m
  ──────────────────────────────────────────
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 72
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  ──────────────────────────────────────────
[0m[0m  [2mpassed              [0m 19
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 11
[0m[0m  [2mhigh                [0m 21
[0m[0m  [2mmedium              [0m 16
[0m[0m  [2mlow                 [0m 10
[0m
[0m  [31m[1m19 passed, 58 potential problem(s) detected.

[0m[2025-05-29 03:27:18] ✅ SUCCESS: TFSec scan completed - no security issues found

============================================================
[2025-05-29 03:27:18] 🛡️ Running Checkov - Infrastructure Security Scanner
============================================================
[2025-05-29 03:27:18] Running Checkov scan on directory...

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.435 

terraform scan results:

Passed checks: 37, Failed checks: 88, Skipped checks: 0

Check: CKV_AWS_100: "Ensure AWS EKS node group does not have implicit SSH access from 0.0.0.0/0"
	PASSED for resource: aws_eks_node_group.vulnerable_nodes
	File: /kubernetes-clusters.tf:36-60
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-5
Check: CKV_AZURE_246: "Ensure Azure AKS cluster HTTP application routing is disabled"
	PASSED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/bc-azure-246
Check: CKV_AZURE_143: "Ensure AKS cluster nodes do not have public IP addresses"
	PASSED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/bc-azure-143
Check: CKV_AZURE_169: "Ensure Azure Kubernetes Cluster (AKS) nodes use scale sets"
	PASSED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/azr-kubernetes-169
Check: CKV_GCP_20: "Ensure master authorized networks is set to enabled in GKE clusters"
	PASSED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-12
Check: CKV_GCP_25: "Ensure Kubernetes Cluster is created with Private cluster enabled"
	PASSED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-6
Check: CKV_GCP_123: "GKE Don't Use NodePools in the Cluster configuration"
	PASSED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-google-cloud-123
Check: CKV_GCP_64: "Ensure clusters are created with Private Nodes"
	PASSED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-clusters-are-created-with-private-nodes
Check: CKV_GCP_71: "Ensure Shielded GKE Nodes are Enabled"
	PASSED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-shielded-gke-nodes-are-enabled
Check: CKV_GCP_72: "Ensure Integrity Monitoring for Shielded GKE Nodes is Enabled"
	PASSED for resource: google_container_node_pool.vulnerable_nodes
	File: /kubernetes-clusters.tf:175-221
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-integrity-monitoring-for-shielded-gke-nodes-is-enabled
Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24
Check: CKV_AWS_88: "EC2 instance should not have public IP."
	PASSED for resource: aws_instance.vulnerable_instance
	File: /main.tf:98-152
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12
Check: CKV_AWS_46: "Ensure no hard-coded secrets exist in EC2 user data"
	PASSED for resource: aws_instance.vulnerable_instance
	File: /main.tf:98-152
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1
Check: CKV_AWS_277: "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1"
	PASSED for resource: aws_security_group.vulnerable_sg
	File: /main.tf:155-205
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports
Check: CKV_AWS_25: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389"
	PASSED for resource: aws_security_group.vulnerable_sg
	File: /main.tf:155-205
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2
Check: CKV_AWS_133: "Ensure that RDS instances has backup policy"
	PASSED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-rds-instances-have-backup-policy
Check: CKV_AWS_388: "Ensure AWS Aurora PostgreSQL is not exposed to local file read vulnerability"
	PASSED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
Check: CKV_AWS_211: "Ensure RDS uses a modern CaCert"
	PASSED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-rds-uses-a-modern-cacert
Check: CKV_AWS_354: "Ensure RDS Performance Insights are encrypted using KMS CMKs"
	PASSED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-354
Check: CKV_AZURE_244: "Avoid the use of local users for Azure Storage unless necessary"
	PASSED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-244
Check: CKV_AZURE_36: "Ensure 'Trusted Microsoft Services' is enabled for Storage Account access"
	PASSED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/enable-trusted-microsoft-services-for-storage-account-access
Check: CKV_GCP_35: "Ensure 'Enable connecting to serial ports' is not enabled for VM Instance"
	PASSED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-11
Check: CKV_GCP_30: "Ensure that instances are not configured to use the default service account"
	PASSED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-gcp-iam-1
Check: CKV_GCP_36: "Ensure that IP forwarding is not enabled on Instances"
	PASSED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-12
Check: CKV_GCP_31: "Ensure that instances are not configured to use the default service account with full access to all Cloud APIs"
	PASSED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-gcp-iam-2
Check: CKV_GCP_75: "Ensure Google compute firewall ingress does not allow unrestricted FTP access"
	PASSED for resource: google_compute_firewall.vulnerable_firewall
	File: /main.tf:356-368
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-ftp-access
Check: CKV_GCP_3: "Ensure Google compute firewall ingress does not allow unrestricted rdp access"
	PASSED for resource: google_compute_firewall.vulnerable_firewall
	File: /main.tf:356-368
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-2
Check: CKV_GCP_77: "Ensure Google compute firewall ingress does not allow on ftp port"
	PASSED for resource: google_compute_firewall.vulnerable_firewall
	File: /main.tf:356-368
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-ftp-port-20-access
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /providers.tf:38-60
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5
Check: CKV2_GCP_12: "Ensure GCP compute firewall ingress does not allow unrestricted access to all ports"
	PASSED for resource: google_compute_firewall.vulnerable_firewall
	File: /main.tf:356-368
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-access-to-all-ports
Check: CKV2_GCP_19: "Ensure GCP Kubernetes engine clusters have 'alpha cluster' feature disabled"
	PASSED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-2-19
Check: CKV2_AZURE_29: "Ensure AKS cluster has Azure CNI networking enabled"
	PASSED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-29
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone
Check: CKV2_AWS_5: "Ensure that Security Groups are attached to another resource"
	PASSED for resource: aws_security_group.vulnerable_sg
	File: /main.tf:155-205
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest
Check: CKV2_AWS_69: "Ensure AWS RDS database instance configured with encryption in transit"
	PASSED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-69
Check: CKV_AWS_39: "Ensure Amazon EKS public endpoint disabled"
	FAILED for resource: aws_eks_cluster.vulnerable_cluster
	File: /kubernetes-clusters.tf:7-33
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-2

		7  | resource "aws_eks_cluster" "vulnerable_cluster" {
		8  |   name     = "vulnerable-eks"
		9  |   role_arn = aws_iam_role.eks_cluster_role.arn
		10 |   version  = "1.18"  # Outdated version
		11 | 
		12 |   vpc_config {
		13 |     subnet_ids              = [aws_subnet.public_subnet.id]  # Public subnets only
		14 |     endpoint_private_access = false
		15 |     endpoint_public_access  = true
		16 |     public_access_cidrs     = ["0.0.0.0/0"]  # Open to internet
		17 |   }
		18 | 
		19 |   # No encryption at rest
		20 |   encryption_config {
		21 |     provider {
		22 |       key_arn = ""  # No encryption key
		23 |     }
		24 |     resources = []
		25 |   }
		26 | 
		27 |   # Logging disabled
		28 |   enabled_cluster_log_types = []
		29 | 
		30 |   tags = {
		31 |     Environment = "production"  # No proper tagging
		32 |   }
		33 | }

Check: CKV_AWS_58: "Ensure EKS Cluster has Secrets Encryption Enabled"
	FAILED for resource: aws_eks_cluster.vulnerable_cluster
	File: /kubernetes-clusters.tf:7-33
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-3

		7  | resource "aws_eks_cluster" "vulnerable_cluster" {
		8  |   name     = "vulnerable-eks"
		9  |   role_arn = aws_iam_role.eks_cluster_role.arn
		10 |   version  = "1.18"  # Outdated version
		11 | 
		12 |   vpc_config {
		13 |     subnet_ids              = [aws_subnet.public_subnet.id]  # Public subnets only
		14 |     endpoint_private_access = false
		15 |     endpoint_public_access  = true
		16 |     public_access_cidrs     = ["0.0.0.0/0"]  # Open to internet
		17 |   }
		18 | 
		19 |   # No encryption at rest
		20 |   encryption_config {
		21 |     provider {
		22 |       key_arn = ""  # No encryption key
		23 |     }
		24 |     resources = []
		25 |   }
		26 | 
		27 |   # Logging disabled
		28 |   enabled_cluster_log_types = []
		29 | 
		30 |   tags = {
		31 |     Environment = "production"  # No proper tagging
		32 |   }
		33 | }

Check: CKV_AWS_37: "Ensure Amazon EKS control plane logging is enabled for all log types"
	FAILED for resource: aws_eks_cluster.vulnerable_cluster
	File: /kubernetes-clusters.tf:7-33
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-4

		7  | resource "aws_eks_cluster" "vulnerable_cluster" {
		8  |   name     = "vulnerable-eks"
		9  |   role_arn = aws_iam_role.eks_cluster_role.arn
		10 |   version  = "1.18"  # Outdated version
		11 | 
		12 |   vpc_config {
		13 |     subnet_ids              = [aws_subnet.public_subnet.id]  # Public subnets only
		14 |     endpoint_private_access = false
		15 |     endpoint_public_access  = true
		16 |     public_access_cidrs     = ["0.0.0.0/0"]  # Open to internet
		17 |   }
		18 | 
		19 |   # No encryption at rest
		20 |   encryption_config {
		21 |     provider {
		22 |       key_arn = ""  # No encryption key
		23 |     }
		24 |     resources = []
		25 |   }
		26 | 
		27 |   # Logging disabled
		28 |   enabled_cluster_log_types = []
		29 | 
		30 |   tags = {
		31 |     Environment = "production"  # No proper tagging
		32 |   }
		33 | }

Check: CKV_AWS_339: "Ensure EKS clusters run on a supported Kubernetes version"
	FAILED for resource: aws_eks_cluster.vulnerable_cluster
	File: /kubernetes-clusters.tf:7-33
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-339

		7  | resource "aws_eks_cluster" "vulnerable_cluster" {
		8  |   name     = "vulnerable-eks"
		9  |   role_arn = aws_iam_role.eks_cluster_role.arn
		10 |   version  = "1.18"  # Outdated version
		11 | 
		12 |   vpc_config {
		13 |     subnet_ids              = [aws_subnet.public_subnet.id]  # Public subnets only
		14 |     endpoint_private_access = false
		15 |     endpoint_public_access  = true
		16 |     public_access_cidrs     = ["0.0.0.0/0"]  # Open to internet
		17 |   }
		18 | 
		19 |   # No encryption at rest
		20 |   encryption_config {
		21 |     provider {
		22 |       key_arn = ""  # No encryption key
		23 |     }
		24 |     resources = []
		25 |   }
		26 | 
		27 |   # Logging disabled
		28 |   enabled_cluster_log_types = []
		29 | 
		30 |   tags = {
		31 |     Environment = "production"  # No proper tagging
		32 |   }
		33 | }

Check: CKV_AWS_38: "Ensure Amazon EKS public endpoint not accessible to 0.0.0.0/0"
	FAILED for resource: aws_eks_cluster.vulnerable_cluster
	File: /kubernetes-clusters.tf:7-33
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-1

		7  | resource "aws_eks_cluster" "vulnerable_cluster" {
		8  |   name     = "vulnerable-eks"
		9  |   role_arn = aws_iam_role.eks_cluster_role.arn
		10 |   version  = "1.18"  # Outdated version
		11 | 
		12 |   vpc_config {
		13 |     subnet_ids              = [aws_subnet.public_subnet.id]  # Public subnets only
		14 |     endpoint_private_access = false
		15 |     endpoint_public_access  = true
		16 |     public_access_cidrs     = ["0.0.0.0/0"]  # Open to internet
		17 |   }
		18 | 
		19 |   # No encryption at rest
		20 |   encryption_config {
		21 |     provider {
		22 |       key_arn = ""  # No encryption key
		23 |     }
		24 |     resources = []
		25 |   }
		26 | 
		27 |   # Logging disabled
		28 |   enabled_cluster_log_types = []
		29 | 
		30 |   tags = {
		31 |     Environment = "production"  # No proper tagging
		32 |   }
		33 | }

Check: CKV_AZURE_141: "Ensure AKS local admin account is disabled"
	FAILED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-iam-policies/ensure-azure-kubernetes-service-aks-local-admin-account-is-disabled

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_117: "Ensure that AKS uses disk encryption set"
	FAILED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/ensure-that-aks-uses-disk-encryption-set

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_170: "Ensure that AKS use the Paid Sku for its SLA"
	FAILED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-170

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_171: "Ensure AKS cluster upgrade channel is chosen"
	FAILED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/azr-networking-171

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_115: "Ensure that AKS enables private clusters"
	FAILED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/ensure-that-aks-enables-private-clusters

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_4: "Ensure AKS logging to Azure Monitoring is Configured"
	FAILED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-1

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_5: "Ensure RBAC is enabled on AKS clusters"
	FAILED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-2

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_8: "Ensure Kubernetes Dashboard is disabled"
	FAILED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-5

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_168: "Ensure Azure Kubernetes Cluster (AKS) nodes should use a minimum number of 50 pods."
	FAILED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/azr-kubernetes-168

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_232: "Ensure that only critical system pods run on system nodes"
	FAILED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azure-232

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_7: "Ensure AKS cluster has Network Policy configured"
	FAILED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-4

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_172: "Ensure autorotation of Secrets Store CSI Driver secrets for AKS clusters"
	FAILED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-172

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_6: "Ensure AKS has an API Server Authorized IP Ranges enabled"
	FAILED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-3

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_116: "Ensure that AKS uses Azure Policies Add-on"
	FAILED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/ensure-that-aks-uses-azure-policies-add-on

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_226: "Ensure ephemeral disks are used for OS disks"
	FAILED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azure-226

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AZURE_227: "Ensure that the AKS cluster encrypt temp disks, caches, and data flows between Compute and Storage resources"
	FAILED for resource: azurerm_kubernetes_cluster.vulnerable_aks
	File: /kubernetes-clusters.tf:63-116
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azure-227

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_7: "Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters"
	FAILED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-2

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_70: "Ensure the GKE Release Channel is set"
	FAILED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-the-gke-release-channel-is-set

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_18: "Ensure GKE Control Plane is not public"
	FAILED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-10

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_8: "Ensure Stackdriver Monitoring is set to Enabled on Kubernetes Engine Clusters"
	FAILED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-3

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_23: "Ensure Kubernetes Cluster is created with Alias IP ranges enabled"
	FAILED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-15

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_66: "Ensure use of Binary Authorization"
	FAILED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-use-of-binary-authorization

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_13: "Ensure client certificate authentication to Kubernetes Engine Clusters is disabled"
	FAILED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-8

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_65: "Manage Kubernetes RBAC users with Google Groups for GKE"
	FAILED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/manage-kubernetes-rbac-users-with-google-groups-for-gke

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_21: "Ensure Kubernetes Clusters are configured with Labels"
	FAILED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-13

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_1: "Ensure Stackdriver Logging is set to Enabled on Kubernetes Engine Clusters"
	FAILED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-1

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_61: "Enable VPC Flow Logs and Intranode Visibility"
	FAILED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/enable-vpc-flow-logs-and-intranode-visibility

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_69: "Ensure the GKE Metadata Server is Enabled"
	FAILED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-the-gke-metadata-server-is-enabled

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_12: "Ensure Network Policy is enabled on Kubernetes Engine Clusters"
	FAILED for resource: google_container_cluster.vulnerable_gke
	File: /kubernetes-clusters.tf:119-172
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-7

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_68: "Ensure Secure Boot for Shielded GKE Nodes is Enabled"
	FAILED for resource: google_container_node_pool.vulnerable_nodes
	File: /kubernetes-clusters.tf:175-221
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-secure-boot-for-shielded-gke-nodes-is-enabled

		175 | resource "google_container_node_pool" "vulnerable_nodes" {
		176 |   name       = "vulnerable-node-pool"
		177 |   location   = "us-central1-a"
		178 |   cluster    = google_container_cluster.vulnerable_gke.name
		179 |   node_count = 3
		180 | 
		181 |   node_config {
		182 |     preemptible  = false
		183 |     machine_type = "e2-medium"
		184 | 
		185 |     # OAuth scopes too broad
		186 |     oauth_scopes = [
		187 |       "https://www.googleapis.com/auth/cloud-platform"  # Full access
		188 |     ]
		189 | 
		190 |     # Service account with excessive permissions
		191 |     service_account = "default"  # Default service account
		192 | 
		193 |     # No disk encryption
		194 |     disk_size_gb = 100
		195 |     disk_type    = "pd-standard"
		196 | 
		197 |     # Image type not specified (uses default)
		198 |     # image_type = ""
		199 | 
		200 |     # Metadata with sensitive info
		201 |     metadata = {
		202 |       disable-legacy-endpoints = "false"  # Legacy endpoints enabled
		203 |       ssh-keys                 = "user:ssh-rsa AAAAB3NzaC1yc2E..."  # SSH key in metadata
		204 |     }
		205 | 
		206 |     # Tags for firewall rules (too permissive)
		207 |     tags = ["web-server", "db-server", "ssh-access"]
		208 |   }
		209 | 
		210 |   # Auto-upgrade disabled
		211 |   management {
		212 |     auto_repair  = false
		213 |     auto_upgrade = false
		214 |   }
		215 | 
		216 |   # Auto-scaling without limits
		217 |   autoscaling {
		218 |     min_node_count = 1
		219 |     max_node_count = 100  # No reasonable limit
		220 |   }
		221 | }

Check: CKV_GCP_9: "Ensure 'Automatic node repair' is enabled for Kubernetes Clusters"
	FAILED for resource: google_container_node_pool.vulnerable_nodes
	File: /kubernetes-clusters.tf:175-221
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-4

		175 | resource "google_container_node_pool" "vulnerable_nodes" {
		176 |   name       = "vulnerable-node-pool"
		177 |   location   = "us-central1-a"
		178 |   cluster    = google_container_cluster.vulnerable_gke.name
		179 |   node_count = 3
		180 | 
		181 |   node_config {
		182 |     preemptible  = false
		183 |     machine_type = "e2-medium"
		184 | 
		185 |     # OAuth scopes too broad
		186 |     oauth_scopes = [
		187 |       "https://www.googleapis.com/auth/cloud-platform"  # Full access
		188 |     ]
		189 | 
		190 |     # Service account with excessive permissions
		191 |     service_account = "default"  # Default service account
		192 | 
		193 |     # No disk encryption
		194 |     disk_size_gb = 100
		195 |     disk_type    = "pd-standard"
		196 | 
		197 |     # Image type not specified (uses default)
		198 |     # image_type = ""
		199 | 
		200 |     # Metadata with sensitive info
		201 |     metadata = {
		202 |       disable-legacy-endpoints = "false"  # Legacy endpoints enabled
		203 |       ssh-keys                 = "user:ssh-rsa AAAAB3NzaC1yc2E..."  # SSH key in metadata
		204 |     }
		205 | 
		206 |     # Tags for firewall rules (too permissive)
		207 |     tags = ["web-server", "db-server", "ssh-access"]
		208 |   }
		209 | 
		210 |   # Auto-upgrade disabled
		211 |   management {
		212 |     auto_repair  = false
		213 |     auto_upgrade = false
		214 |   }
		215 | 
		216 |   # Auto-scaling without limits
		217 |   autoscaling {
		218 |     min_node_count = 1
		219 |     max_node_count = 100  # No reasonable limit
		220 |   }
		221 | }

Check: CKV_GCP_10: "Ensure 'Automatic node upgrade' is enabled for Kubernetes Clusters"
	FAILED for resource: google_container_node_pool.vulnerable_nodes
	File: /kubernetes-clusters.tf:175-221
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-5

		175 | resource "google_container_node_pool" "vulnerable_nodes" {
		176 |   name       = "vulnerable-node-pool"
		177 |   location   = "us-central1-a"
		178 |   cluster    = google_container_cluster.vulnerable_gke.name
		179 |   node_count = 3
		180 | 
		181 |   node_config {
		182 |     preemptible  = false
		183 |     machine_type = "e2-medium"
		184 | 
		185 |     # OAuth scopes too broad
		186 |     oauth_scopes = [
		187 |       "https://www.googleapis.com/auth/cloud-platform"  # Full access
		188 |     ]
		189 | 
		190 |     # Service account with excessive permissions
		191 |     service_account = "default"  # Default service account
		192 | 
		193 |     # No disk encryption
		194 |     disk_size_gb = 100
		195 |     disk_type    = "pd-standard"
		196 | 
		197 |     # Image type not specified (uses default)
		198 |     # image_type = ""
		199 | 
		200 |     # Metadata with sensitive info
		201 |     metadata = {
		202 |       disable-legacy-endpoints = "false"  # Legacy endpoints enabled
		203 |       ssh-keys                 = "user:ssh-rsa AAAAB3NzaC1yc2E..."  # SSH key in metadata
		204 |     }
		205 | 
		206 |     # Tags for firewall rules (too permissive)
		207 |     tags = ["web-server", "db-server", "ssh-access"]
		208 |   }
		209 | 
		210 |   # Auto-upgrade disabled
		211 |   management {
		212 |     auto_repair  = false
		213 |     auto_upgrade = false
		214 |   }
		215 | 
		216 |   # Auto-scaling without limits
		217 |   autoscaling {
		218 |     min_node_count = 1
		219 |     max_node_count = 100  # No reasonable limit
		220 |   }
		221 | }

Check: CKV_GCP_69: "Ensure the GKE Metadata Server is Enabled"
	FAILED for resource: google_container_node_pool.vulnerable_nodes
	File: /kubernetes-clusters.tf:175-221
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-the-gke-metadata-server-is-enabled

		175 | resource "google_container_node_pool" "vulnerable_nodes" {
		176 |   name       = "vulnerable-node-pool"
		177 |   location   = "us-central1-a"
		178 |   cluster    = google_container_cluster.vulnerable_gke.name
		179 |   node_count = 3
		180 | 
		181 |   node_config {
		182 |     preemptible  = false
		183 |     machine_type = "e2-medium"
		184 | 
		185 |     # OAuth scopes too broad
		186 |     oauth_scopes = [
		187 |       "https://www.googleapis.com/auth/cloud-platform"  # Full access
		188 |     ]
		189 | 
		190 |     # Service account with excessive permissions
		191 |     service_account = "default"  # Default service account
		192 | 
		193 |     # No disk encryption
		194 |     disk_size_gb = 100
		195 |     disk_type    = "pd-standard"
		196 | 
		197 |     # Image type not specified (uses default)
		198 |     # image_type = ""
		199 | 
		200 |     # Metadata with sensitive info
		201 |     metadata = {
		202 |       disable-legacy-endpoints = "false"  # Legacy endpoints enabled
		203 |       ssh-keys                 = "user:ssh-rsa AAAAB3NzaC1yc2E..."  # SSH key in metadata
		204 |     }
		205 | 
		206 |     # Tags for firewall rules (too permissive)
		207 |     tags = ["web-server", "db-server", "ssh-access"]
		208 |   }
		209 | 
		210 |   # Auto-upgrade disabled
		211 |   management {
		212 |     auto_repair  = false
		213 |     auto_upgrade = false
		214 |   }
		215 | 
		216 |   # Auto-scaling without limits
		217 |   autoscaling {
		218 |     min_node_count = 1
		219 |     max_node_count = 100  # No reasonable limit
		220 |   }
		221 | }

Check: CKV_AWS_55: "Ensure S3 bucket has ignore public ACLs enabled"
	FAILED for resource: aws_s3_bucket_public_access_block.vulnerable_bucket_pab
	File: /main.tf:69-76
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21

		69 | resource "aws_s3_bucket_public_access_block" "vulnerable_bucket_pab" {
		70 |   bucket = aws_s3_bucket.vulnerable_bucket.id
		71 | 
		72 |   block_public_acls       = false
		73 |   block_public_policy     = false
		74 |   ignore_public_acls      = false
		75 |   restrict_public_buckets = false
		76 | }

Check: CKV_AWS_56: "Ensure S3 bucket has 'restrict_public_buckets' enabled"
	FAILED for resource: aws_s3_bucket_public_access_block.vulnerable_bucket_pab
	File: /main.tf:69-76
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22

		69 | resource "aws_s3_bucket_public_access_block" "vulnerable_bucket_pab" {
		70 |   bucket = aws_s3_bucket.vulnerable_bucket.id
		71 | 
		72 |   block_public_acls       = false
		73 |   block_public_policy     = false
		74 |   ignore_public_acls      = false
		75 |   restrict_public_buckets = false
		76 | }

Check: CKV_AWS_53: "Ensure S3 bucket has block public ACLS enabled"
	FAILED for resource: aws_s3_bucket_public_access_block.vulnerable_bucket_pab
	File: /main.tf:69-76
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19

		69 | resource "aws_s3_bucket_public_access_block" "vulnerable_bucket_pab" {
		70 |   bucket = aws_s3_bucket.vulnerable_bucket.id
		71 | 
		72 |   block_public_acls       = false
		73 |   block_public_policy     = false
		74 |   ignore_public_acls      = false
		75 |   restrict_public_buckets = false
		76 | }

Check: CKV_AWS_54: "Ensure S3 bucket has block public policy enabled"
	FAILED for resource: aws_s3_bucket_public_access_block.vulnerable_bucket_pab
	File: /main.tf:69-76
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20

		69 | resource "aws_s3_bucket_public_access_block" "vulnerable_bucket_pab" {
		70 |   bucket = aws_s3_bucket.vulnerable_bucket.id
		71 | 
		72 |   block_public_acls       = false
		73 |   block_public_policy     = false
		74 |   ignore_public_acls      = false
		75 |   restrict_public_buckets = false
		76 | }

Check: CKV_AWS_135: "Ensure that EC2 is EBS optimized"
	FAILED for resource: aws_instance.vulnerable_instance
	File: /main.tf:98-152
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_126: "Ensure that detailed monitoring is enabled for EC2 instances"
	FAILED for resource: aws_instance.vulnerable_instance
	File: /main.tf:98-152
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_79: "Ensure Instance Metadata Service Version 1 is not enabled"
	FAILED for resource: aws_instance.vulnerable_instance
	File: /main.tf:98-152
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_8: "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"
	FAILED for resource: aws_instance.vulnerable_instance
	File: /main.tf:98-152
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_24: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"
	FAILED for resource: aws_security_group.vulnerable_sg
	File: /main.tf:155-205
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_23: "Ensure every security group and rule has a description"
	FAILED for resource: aws_security_group.vulnerable_sg
	File: /main.tf:155-205
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_260: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"
	FAILED for resource: aws_security_group.vulnerable_sg
	File: /main.tf:155-205
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_382: "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"
	FAILED for resource: aws_security_group.vulnerable_sg
	File: /main.tf:155-205
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_AWS_161: "Ensure RDS database has IAM authentication enabled"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-rds-database-has-iam-authentication-enabled

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV_AWS_16: "Ensure all data stored in the RDS is securely encrypted at rest"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-4

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV_AWS_129: "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-that-respective-logs-of-amazon-relational-database-service-amazon-rds-are-enabled

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV_AWS_157: "Ensure that RDS instances have Multi-AZ enabled"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-73

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV_AWS_293: "Ensure that AWS database instances have deletion protection enabled"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-293

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV_AWS_17: "Ensure all data stored in RDS is not publicly accessible"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-2

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV_AWS_118: "Ensure that enhanced monitoring is enabled for Amazon RDS instances"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV_AWS_226: "Ensure DB instance gets all minor upgrades automatically"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-db-instance-gets-all-minor-upgrades-automatically

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV_AZURE_44: "Ensure Storage Account is using the latest version of TLS encryption"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-storage-policies/bc-azr-storage-2

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV_AZURE_206: "Ensure that Storage Accounts use replication"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-206

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV_AZURE_59: "Ensure that Storage accounts disallow public access"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV_AZURE_33: "Ensure Storage logging is enabled for Queue service for read, write and delete requests"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-logging-policies/enable-requests-on-storage-logging-for-queue-service

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV_AZURE_190: "Ensure that Storage blobs restrict public access"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/azr-networking-190

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV_AZURE_3: "Ensure that 'enable_https_traffic_only' is enabled"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-3

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV_GCP_34: "Ensure that no instance in the project overrides the project setting for enabling OSLogin(OSLogin needs to be enabled in project metadata for all instances)"
	FAILED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-10

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_38: "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)"
	FAILED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-general-policies/encrypt-boot-disks-for-instances-with-cseks

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_39: "Ensure Compute instances are launched with Shielded VM enabled"
	FAILED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-general-policies/bc-gcp-general-y

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_32: "Ensure 'Block Project-wide SSH keys' is enabled for VM instances"
	FAILED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-8

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_40: "Ensure that Compute instances do not have public IP addresses"
	FAILED for resource: google_compute_instance.vulnerable_vm
	File: /main.tf:302-353
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-public-policies/bc-gcp-public-2

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV_GCP_106: "Ensure Google compute firewall ingress does not allow unrestricted http port 80 access"
	FAILED for resource: google_compute_firewall.vulnerable_firewall
	File: /main.tf:356-368
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-http-port-80-access

		356 | resource "google_compute_firewall" "vulnerable_firewall" {
		357 |   name    = "vulnerable-firewall"
		358 |   network = "default"
		359 |   
		360 |   allow {
		361 |     protocol = "tcp"
		362 |     ports    = ["22", "80", "443", "3306", "5432", "1433"]
		363 |   }
		364 |   
		365 |   # Issue: Source ranges too broad
		366 |   source_ranges = ["0.0.0.0/0"]
		367 |   target_tags   = ["webserver", "database"]
		368 | }

Check: CKV_GCP_2: "Ensure Google compute firewall ingress does not allow unrestricted ssh access"
	FAILED for resource: google_compute_firewall.vulnerable_firewall
	File: /main.tf:356-368
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-1

		356 | resource "google_compute_firewall" "vulnerable_firewall" {
		357 |   name    = "vulnerable-firewall"
		358 |   network = "default"
		359 |   
		360 |   allow {
		361 |     protocol = "tcp"
		362 |     ports    = ["22", "80", "443", "3306", "5432", "1433"]
		363 |   }
		364 |   
		365 |   # Issue: Source ranges too broad
		366 |   source_ranges = ["0.0.0.0/0"]
		367 |   target_tags   = ["webserver", "database"]
		368 | }

Check: CKV_GCP_88: "Ensure Google compute firewall ingress does not allow unrestricted mysql access"
	FAILED for resource: google_compute_firewall.vulnerable_firewall
	File: /main.tf:356-368
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-compute-firewall-ingress-does-not-allow-unrestricted-mysql-access

		356 | resource "google_compute_firewall" "vulnerable_firewall" {
		357 |   name    = "vulnerable-firewall"
		358 |   network = "default"
		359 |   
		360 |   allow {
		361 |     protocol = "tcp"
		362 |     ports    = ["22", "80", "443", "3306", "5432", "1433"]
		363 |   }
		364 |   
		365 |   # Issue: Source ranges too broad
		366 |   source_ranges = ["0.0.0.0/0"]
		367 |   target_tags   = ["webserver", "database"]
		368 | }

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	FAILED for resource: aws.default
	File: /main.tf:31-36
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5

		31 | provider "aws" {
		32 |   region = var.aws_region
		33 |   # Issue: Hardcoded credentials (should use IAM roles/profiles)
		34 |   access_key = "AKIAI**********"
		35 |   secret_key = "wJalrX**********"
		36 | }

Check: CKV2_AZURE_33: "Ensure storage account is configured with private endpoint"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-33

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV2_AZURE_40: "Ensure storage account is not configured with Shared Key authorization"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-iam-policies/bc-azure-2-40

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV2_AZURE_47: "Ensure storage account is configured without blob anonymous access"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-iam-policies/bc-azure-2-47

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV2_AZURE_41: "Ensure storage account is configured with SAS expiration policy"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-iam-policies/bc-azure-2-41

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV2_AZURE_1: "Ensure storage for critical data are encrypted with Customer Managed Key"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV2_AZURE_38: "Ensure soft-delete is enabled on Azure storage account"
	FAILED for resource: azurerm_storage_account.vulnerable_storage
	File: /main.tf:270-297
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-38

		270 | resource "azurerm_storage_account" "vulnerable_storage" {
		271 |   name                = "vulnerablestorage${random_string.storage_suffix.result}"
		272 |   resource_group_name = azurerm_resource_group.vulnerable_rg.name
		273 |   location            = azurerm_resource_group.vulnerable_rg.location
		274 |   
		275 |   account_tier     = "Standard"
		276 |   account_replication_type = "LRS"
		277 |   
		278 |   # Issue: Public access allowed
		279 |   allow_nested_items_to_be_public = true
		280 |   
		281 |   # Issue: Secure transfer not required
		282 |   enable_https_traffic_only = false
		283 |   
		284 |   # Issue: Minimum TLS version too low
		285 |   min_tls_version = "TLS1_0"
		286 |   
		287 |   # Issue: No network rules
		288 |   # network_rules {
		289 |   #   default_action = "Deny"
		290 |   # }
		291 |   
		292 |   tags = {
		293 |     environment = "production"
		294 |     # Issue: Secrets in tags
		295 |     connection_string = "DefaultEndpointsProtocol=https;AccountName=test;AccountKey=key123"
		296 |   }
		297 | }

Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61

		57 | resource "aws_s3_bucket" "vulnerable_bucket" {
		58 |   bucket = "my-super-secret-company-data-${random_string.bucket_suffix.result}"
		59 |   
		60 |   tags = {
		61 |     Environment = "production"
		62 |     # Issue: Sensitive information in tags
		63 |     DatabasePassword = "admin123"
		64 |     ApiKey          = var.api_key
		65 |   }
		66 | }

Check: CKV2_AWS_60: "Ensure RDS instance with copy tags to snapshots is enabled"
	FAILED for resource: aws_db_instance.vulnerable_db
	File: /main.tf:208-253
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-60

		208 | resource "aws_db_instance" "vulnerable_db" {
		209 |   identifier = "vulnerable-database"
		210 |   
		211 |   engine         = "mysql"
		212 |   engine_version = "5.7"  # Issue: Outdated version
		213 |   instance_class = "db.t3.micro"
		214 |   
		215 |   allocated_storage     = 20
		216 |   max_allocated_storage = 100
		217 |   
		218 |   # Issue: Hardcoded database credentials
		219 |   db_name  = "testdb"
		220 |   username = "admin"
		221 |   password = "admin123"  # Issue: Weak password in code
		222 |   
		223 |   # Issue: Public access enabled
		224 |   publicly_accessible = true
		225 |   
		226 |   # Issue: No encryption at rest
		227 |   storage_encrypted = false
		228 |   
		229 |   # Issue: Backup retention too short
		230 |   backup_retention_period = 1
		231 |   backup_window          = "03:00-04:00"
		232 |   
		233 |   # Issue: No maintenance window specified
		234 |   # maintenance_window = "sun:04:00-sun:05:00"
		235 |   
		236 |   # Issue: Deletion protection disabled
		237 |   deletion_protection = false
		238 |   
		239 |   # Issue: Skip final snapshot
		240 |   skip_final_snapshot = true
		241 |   
		242 |   # Issue: No monitoring
		243 |   monitoring_interval = 0
		244 |   
		245 |   # Issue: No enhanced monitoring
		246 |   enabled_cloudwatch_logs_exports = []
		247 |   
		248 |   tags = {
		249 |     Name = "vulnerable-database"
		250 |     # Issue: Sensitive info in tags
		251 |     MasterPassword = "admin123"
		252 |   }
		253 | }

Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled

		57 | resource "aws_s3_bucket" "vulnerable_bucket" {
		58 |   bucket = "my-super-secret-company-data-${random_string.bucket_suffix.result}"
		59 |   
		60 |   tags = {
		61 |     Environment = "production"
		62 |     # Issue: Sensitive information in tags
		63 |     DatabasePassword = "admin123"
		64 |     ApiKey          = var.api_key
		65 |   }
		66 | }

Check: CKV2_AWS_41: "Ensure an IAM role is attached to EC2 instance"
	FAILED for resource: aws_instance.vulnerable_instance
	File: /main.tf:98-152
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance

		Code lines for this resource are too many. Please use IDE of your choice to review the file.
Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	FAILED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached

		57 | resource "aws_s3_bucket" "vulnerable_bucket" {
		58 |   bucket = "my-super-secret-company-data-${random_string.bucket_suffix.result}"
		59 |   
		60 |   tags = {
		61 |     Environment = "production"
		62 |     # Issue: Sensitive information in tags
		63 |     DatabasePassword = "admin123"
		64 |     ApiKey          = var.api_key
		65 |   }
		66 | }

Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62

		57 | resource "aws_s3_bucket" "vulnerable_bucket" {
		58 |   bucket = "my-super-secret-company-data-${random_string.bucket_suffix.result}"
		59 |   
		60 |   tags = {
		61 |     Environment = "production"
		62 |     # Issue: Sensitive information in tags
		63 |     DatabasePassword = "admin123"
		64 |     ApiKey          = var.api_key
		65 |   }
		66 | }

Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging

		57 | resource "aws_s3_bucket" "vulnerable_bucket" {
		58 |   bucket = "my-super-secret-company-data-${random_string.bucket_suffix.result}"
		59 |   
		60 |   tags = {
		61 |     Environment = "production"
		62 |     # Issue: Sensitive information in tags
		63 |     DatabasePassword = "admin123"
		64 |     ApiKey          = var.api_key
		65 |   }
		66 | }

Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default

		57 | resource "aws_s3_bucket" "vulnerable_bucket" {
		58 |   bucket = "my-super-secret-company-data-${random_string.bucket_suffix.result}"
		59 |   
		60 |   tags = {
		61 |     Environment = "production"
		62 |     # Issue: Sensitive information in tags
		63 |     DatabasePassword = "admin123"
		64 |     ApiKey          = var.api_key
		65 |   }
		66 | }

Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.vulnerable_bucket
	File: /main.tf:57-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning

		57 | resource "aws_s3_bucket" "vulnerable_bucket" {
		58 |   bucket = "my-super-secret-company-data-${random_string.bucket_suffix.result}"
		59 |   
		60 |   tags = {
		61 |     Environment = "production"
		62 |     # Issue: Sensitive information in tags
		63 |     DatabasePassword = "admin123"
		64 |     ApiKey          = var.api_key
		65 |   }
		66 | }


[2025-05-29 03:27:21] ✅ SUCCESS: Checkov scan completed - no issues found

============================================================
[2025-05-29 03:27:21] 📊 Scan Summary and Results
============================================================
[2025-05-29 03:27:21] Target: test-files/terraform/
[2025-05-29 03:27:21] Scan type: directory
[2025-05-29 03:27:21] 🕐 Scan completed: Thu May 29 03:27:21 UTC 2025
[2025-05-29 03:27:21] ============================================================
[2025-05-29 03:27:22] TOOL EXECUTION RESULTS:
[2025-05-29 03:27:22] - TFLint: ✅ PASSED
[2025-05-29 03:27:22] - TFSec: ✅ PASSED
[2025-05-29 03:27:22] - Checkov: ✅ PASSED
[2025-05-29 03:27:22] ============================================================
[2025-05-29 03:27:22] ✅ SUCCESS: Overall scan result: ALL TOOLS PASSED - No critical issues found!
[2025-05-29 03:27:22] 📄 Complete scan log saved to: terraform-scan-report.log
[2025-05-29 03:27:22] 🎯 All tool outputs captured with timestamps and exit codes
